(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{137:function(t,e,s){},146:function(t,e,s){t.exports=s(333)},151:function(t,e,s){},152:function(t,e,s){},183:function(t,e,s){},331:function(t,e,s){},332:function(t,e,s){},333:function(t,e,s){"use strict";s.r(e);var i=s(0),a=s.n(i),n=s(32),o=s.n(n),h=(s(151),s(152),s(4)),r=s(10),l=s(16),c=s(15),p=s(55),u=s(33),d=s(52),f=s(35),m=(s(93),s(17)),b=s(1),g=s(19),v="pool/pooltable.babylon",R="carom/caromtable.babylon",V="bat.babylon",M=375,w=384,P=6,y=7,_=8,C=9,x=10,S=11,N=12,T=13,E=14,A=15,O=16,Y=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],L=[0,21,22],X=function t(){Object(h.a)(this,t),this.played=!1},I=function t(){Object(h.a)(this,t)},q=function t(e,s){var i=this;Object(h.a)(this,t),this.delta_fgpas=.004375,this.RSG=1,this.fgpas=.00125,this.EPSILON=.86,this.frpas=3e-5,this.QCQ=2,this.Rfppas=75e-6,this.f1=.25,this.f2=.42,this.Rfp=.15,this.fbille=.05,this.pas=5e-4,this.fp1=.2,this.ARRET=0,this.TSP=3,this.fg=2.5,this.fr=.06,this.choc_bande=function(t){var e=NaN;if(i.X[t]>i.XMIN&&i.X[t]<i.XMAX&&i.Y[t]>i.YMIN&&i.Y[t]<i.YMAX)return!1;if(i.X[t]<i.XMIN&&i.Vx[t]>0)return!1;if(i.X[t]>i.XMAX&&i.Vx[t]<0)return!1;if(i.Y[t]>i.YMAX&&i.Vy[t]<0)return!1;if(i.Y[t]<i.YMIN&&i.Vy[t]>0)return!1;if(0===t&&(!i.choc12||!i.choc13)){var s=i,a=i.nbandes+1;s.nbandes=a,i.choc12||i.choc13||(s=i,a=i.nb_b_avant+1,s.nb_b_avant=a)}return i.etat[t]===i.RSG?(i.Rp[t]=-i.Vy[t],i.Rq[t]=i.Vx[t]):i.etat[t]===i.QCQ&&(i.Rp[t]=-i.Vy[t]+i.VQy[t],i.Rq[t]=i.Vx[t]-i.VQx[t]),i.init_pars(t),i.VMz=i.VT-i.VRr,i.VN0=-i.VN,i.VN=i.VN*-i.EPSILON,i.deltaVN=i.VN0+i.VN,i.intens=i.VN0/20,i.intens>1&&(i.intens=1),i.beta_adh=2/7*Math.sqrt(i.VMz*i.VMz+i.VRq*i.VRq),i.beta_gliss=i.f1*i.deltaVN,Math.abs(i.VMz)<1e-5?i.alpha_bande=Math.PI/2:i.alpha_bande=Math.abs(Math.atan(i.VRq/i.VMz)),e=Math.abs(i.fp1*i.deltaVN),Math.abs(i.VRp)<e?i.VRp=0:i.VRp>0?i.VRp=i.VRp-e:i.VRp=i.VRp+e,e=Math.abs(i.f2*i.deltaVN),i.VRq=i.VRq+e,i.beta_gliss>i.beta_adh?i.choc_adh(t):i.choc_gliss(t),i.recup_pars(t),i.VQx[t]=i.Vx[t]-i.Rq[t],i.VQy[t]=i.Vy[t]+i.Rp[t],i.etat[t]=i.QCQ,!0},this.fin_parcours=function(){var t=0;for(t=0;t<3;){if(i.etat[t]!==i.ARRET){if(!(i.Vx[t]*i.Vx[t]+i.Vy[t]*i.Vy[t]<i.frpas*i.frpas))return!1;if(!(Math.abs(i.Rr[t])<i.Rfppas))return i.etat[t]=i.TSP,!1;i.etat[t]=i.ARRET;var e=0;i.Vy[t]=0,i.Vx[t]=e,e=0,i.Rr[t]=0,i.Rq[t]=e,i.Rp[t]=e}t++}return!0},this.Calcul=function(t){var e,s,a=0,n=0,o=NaN,h=[];for(a=0;a<3;){for(i.nb_clefs[a]=0,n=0;n<i.nb_max_clefs;)i.evts[i.nb_max_clefs*a+n]=null,n++;a++}for(i.nb_sons=0,a=0;a<i.nb_max_sons;)i.evts_son[a]=null,a++;for(a=0;a<3;)i.X[a]=t.Xinit[a],i.Y[a]=t.Yinit[a],i.RAp[a]=t.RApInit[a],i.RAq[a]=t.RAqInit[a],i.RAr[a]=t.RArInit[a],i.add_clef(a),a++;i.el=t.el,i.er=t.er,i.alph=t.alphaQ,i.beta=t.betaQ,i.vqueue=t.Vqueue,i.calculs_finis=!1,i.nbandes=0,i.done=!1,i.distance13=2,i.first_bille_choquee=0,i.choc12=!1,i.choc13=!1,i.done=!1,i.deltaclef=i.resolution,i.date=0,i.beta=i.beta+Math.PI,i.Vinit=1.4*i.vqueue*Math.cos(i.alph/1.2),e=-2*i.Vinit/Math.cos(i.alph/1.1)*i.er/i.R;var r=Math.PI/20;o=i.alph>r?Math.PI/2/(Math.PI/2-r)*(i.alph-r):0,s=4*i.vqueue*Math.sin(o)*i.el/i.R,i.Vx[0]=i.Vinit*Math.cos(i.beta),i.Vx0=i.Vx[0],i.Vy[0]=i.Vinit*Math.sin(i.beta),i.Vy0=i.Vy[0];var l=e*Math.sin(i.beta)+s*Math.cos(i.beta);for(i.Rp[0]=e*Math.sin(i.beta)+s*Math.cos(i.beta),i.p0=l,l=-e*Math.cos(i.beta)+s*Math.sin(i.beta),i.Rq[0]=-e*Math.cos(i.beta)+s*Math.sin(i.beta),i.q0=l,l=2*i.el/i.R*i.Vinit,i.Rr[0]=2*i.el/i.R*i.Vinit,i.r0=l,i.VQx[0]=i.Vx[0]-i.Rq[0],i.VQy[0]=i.Vy[0]+i.Rp[0],i.etat[0]=i.QCQ,a=1;a<3;)i.Vx[a]=0,i.Vy[a]=0,i.VQx[a]=0,i.VQy[a]=0,i.Rp[a]=0,i.Rq[a]=0,i.Rr[a]=0,i.etat[a]=i.ARRET,i.add_clef(a),a++;for(i.evts_son[i.nb_sons]=new X,i.evts_son[i.nb_sons].played=!1,i.evts_son[i.nb_sons].temps=0,i.evts_son[i.nb_sons].intensite=i.Vinit/5.4,i.alph>Math.PI/4?i.evts_son[i.nb_sons].type_choc=0:i.evts_son[i.nb_sons].type_choc=1;!i.fin_parcours();)for(i.date+=1,i.choc_billes(h),a=0;a<3;){if(i.etat[a]!==i.ARRET){if(i.choc_bande(a)){i.add_clef(a),i.evts_son[i.nb_sons]=new X,i.evts_son[i.nb_sons].played=!1,i.evts_son[i.nb_sons].temps=i.date*i.pas,i.evts_son[i.nb_sons].intensite=i.intens,i.evts_son[i.nb_sons].type_choc=3,l=i;var c=i.nb_sons+1;l.nb_sons=c}i.mise_a_jour(a)&&i.add_clef(a)}(Math.abs(i.X[a]-i.X0[a])>i.deltaclef||Math.abs(i.Y[a]-i.Y0[a])>i.deltaclef||Math.abs(i.RAp[a]-i.RAp0[a])>i.deltaclefRot||Math.abs(i.RAq[a]-i.RAq0[a])>i.deltaclefRot||Math.abs(i.RAr[a]-i.RAr0[a])>i.deltaclefRot)&&i.add_clef(a),a++}if(i.fin_parcours()){for(i.calculs_finis=!0,a=0;a<3;a++)i.Xfin[a]=i.X[a],i.Yfin[a]=i.Y[a],i.RApfin[a]=i.RAp[a],i.RAqfin[a]=i.RAq[a],i.RArfin[a]=i.RAr[a],i.add_clef(a);i.duree=i.date*i.pas}else for(a=0;a<3;a++)i.add_clef(a);return{sounds:i.evts_son,data:i.evts}},this.mise_a_jour=function(t){var e=NaN,s=NaN,a=NaN,n=NaN,o=NaN;if(0!==i.first_bille_choquee&&(i.nb3=3-i.first_bille_choquee,i.d13=Math.sqrt((i.X[0]-i.X[i.nb3])*(i.X[0]-i.X[i.nb3])+(i.Y[0]-i.Y[i.nb3])*(i.Y[0]-i.Y[i.nb3])),i.d13<i.distance13&&(i.distance13=i.d13)),i.etat[t]===i.RSG){if((e=Math.sqrt(i.Vx[t]*i.Vx[t]+i.Vy[t]*i.Vy[t]))<i.frpas){var h=0;if(i.Vy[t]=0,i.Vx[t]=h,h=0,i.Rq[t]=0,i.Rp[t]=h,Math.abs(i.Rr[t])<i.Rfppas)return i.etat[t]=i.ARRET,i.Rr[t]=0,i.add_clef(t),!0;i.etat[t]=i.TSP}i.etat[t]!==i.TSP&&(s=1-i.frpas/e,i.Vx[t]=i.Vx[t]*s,i.Vy[t]=i.Vy[t]*s,i.Rp[t]=-i.Vy[t],i.Rq[t]=i.Vx[t]),Math.abs(i.Rr[t])<i.Rfppas?i.Rr[t]=0:i.Rr[t]>0?i.Rr[t]=i.Rr[t]-i.Rfppas:i.Rr[t]=i.Rr[t]+i.Rfppas}if(i.etat[t]===i.QCQ&&((a=Math.sqrt(i.VQx[t]*i.VQx[t]+i.VQy[t]*i.VQy[t]))<i.delta_fgpas?i.etat[t]=i.RSG:(n=-i.fgpas*i.VQx[t]/a,o=-i.fgpas*i.VQy[t]/a,i.Vx[t]=i.Vx[t]+n,i.Vy[t]=i.Vy[t]+o,s=1-i.delta_fgpas/a,i.VQx[t]=i.VQx[t]*s,i.VQy[t]=i.VQy[t]*s),i.Rp[t]=-i.Vy[t]+i.VQy[t],i.Rq[t]=i.Vx[t]-i.VQx[t],Math.abs(i.Rr[t])<i.Rfppas?i.Rr[t]=0:i.Rr[t]>0?i.Rr[t]=i.Rr[t]-i.Rfppas:i.Rr[t]=i.Rr[t]+i.Rfppas),i.etat[t]===i.TSP){if(h=0,i.Vy[t]=0,i.Vx[t]=h,h=0,i.Rq[t]=0,i.Rp[t]=h,Math.abs(i.Rr[t])<i.Rfppas)return i.Rr[t]=0,i.etat[t]=i.ARRET,!0;i.Rr[t]>0?i.Rr[t]=i.Rr[t]-2*i.Rfppas:i.Rr[t]=i.Rr[t]+2*i.Rfppas}return i.X[t]=i.X[t]+i.Vx[t]*i.pas,i.Y[t]=i.Y[t]+i.Vy[t]*i.pas,i.RAp[t]=i.RAp[t]+i.Rp[t]*i.pas,i.RAq[t]=i.RAq[t]+i.Rq[t]*i.pas,i.RAr[t]=i.RAr[t]+i.Rr[t]*i.pas,!1},this.choc_gliss=function(t){i.VMz>0?(i.VT=i.VT-i.beta_gliss*Math.cos(i.alpha_bande),i.VRr=i.VRr+2.5*i.beta_gliss*Math.cos(i.alpha_bande)):(i.VT=i.VT+i.beta_gliss*Math.cos(i.alpha_bande),i.VRr=i.VRr-2.5*i.beta_gliss*Math.cos(i.alpha_bande))},this.choc_adh=function(t){var e,s,a=NaN,n=NaN,o=NaN,h=NaN,r=NaN,l=0;a=Math.abs(i.VT)<1e-5?90:180/Math.PI*Math.atan(i.VN0/i.VT),i.effet=100*i.R/2*i.VRr/Math.sqrt(i.VN0*i.VN0+i.VT*i.VT),i.effet<=-1.5?i.effet=-1.499:i.effet>1.5&&(i.effet=1.499),Math.abs(i.VT)<1e-5?n=i.effet>0?i.sorties[28]+(i.sorties[29]-i.sorties[28])*(i.effet/1.5):i.sorties[27]+(i.sorties[28]-i.sorties[27])*(i.effet+1.5)/1.5:(a=180/Math.PI*Math.atan(i.VN0/i.VT),l=parseInt(a/10,10),n=(o=i.effet>0?i.sorties[3*l+1]+(i.sorties[3*l+2]-i.sorties[3*l+1])*(i.effet/1.5):i.sorties[3*l+0]+(i.sorties[3*l+1]-i.sorties[3*l+0])*(i.effet+1.5)/1.5)+((i.effet>0?i.sorties[3*(l+1)+1]+(i.sorties[3*(l+1)+2]-i.sorties[3*(l+1)+1])*(i.effet/1.5):i.sorties[3*(l+1)+0]+(i.sorties[3*(l+1)+1]-i.sorties[3*(l+1)+0])*(i.effet+1.5)/1.5)-o)/10*(a-10*l)),Math.abs(n-90)<1e-5?i.VT=0:i.VT=n<90?i.VN/Math.tan(n/180*Math.PI):-i.VN*Math.tan((n-90)/180*Math.PI),Math.abs(i.VT)<1e-5?i.effet>0?i.e_s=i.eff_s[28]+(i.eff_s[29]-i.eff_s[28])*(i.effet/1.5):i.e_s=i.eff_s[27]+(i.eff_s[28]-i.eff_s[27])*(i.effet+1.5)/1.5:(i.effet>0?(h=i.eff_s[3*l+1]+(i.eff_s[3*l+2]-i.eff_s[3*l+1])*(i.effet/1.5),r=i.eff_s[3*(l+1)+1]+(i.eff_s[3*(l+1)+2]-i.eff_s[3*(l+1)+1])*(i.effet/1.5)):(h=i.eff_s[3*l+0]+(i.eff_s[3*l+1]-i.eff_s[3*l+0])*(i.effet+1.5)/1.5,r=i.eff_s[3*(l+1)+0]+(i.eff_s[3*(l+1)+1]-i.eff_s[3*(l+1)+0])*(i.effet+1.5)/1.5),i.e_s=h+(r-h)/10*(a-10*l)),s=(5*i.VN+2*i.VRq)/7,e=(5*i.VT-2*i.VRp)/7,i.VRr=.02*i.e_s/i.R*Math.sqrt(s*s+e*e)},this.recup_pars=function(t){i.X[t]>i.XMAX&&i.Vx[t]>0&&(i.Vx[t]=-i.VN,i.Rq[t]=-i.VRq,i.Vy[t]>0?(i.Vy[t]=i.VT,i.Rp[t]=i.VRp,i.Rr[t]=-i.VRr):(i.Vy[t]=-i.VT,i.Rp[t]=-i.VRp,i.Rr[t]=i.VRr)),i.X[t]<i.XMIN&&i.Vx[t]<0&&(i.Vx[t]=i.VN,i.Rq[t]=i.VRq,i.Vy[t]>0?(i.Vy[t]=i.VT,i.Rp[t]=i.VRp,i.Rr[t]=i.VRr):(i.Vy[t]=-i.VT,i.Rp[t]=-i.VRp,i.Rr[t]=-i.VRr)),i.Y[t]<i.YMIN&&i.Vy[t]<0&&(i.Vy[t]=i.VN,i.Rp[t]=-i.VRq,i.Vx[t]>0?(i.Vx[t]=i.VT,i.Rq[t]=-i.VRp,i.Rr[t]=-i.VRr):(i.Vx[t]=-i.VT,i.Rq[t]=i.VRp,i.Rr[t]=i.VRr)),i.Y[t]>i.YMAX&&i.Vy[t]>0&&(i.Vy[t]=-i.VN,i.Rp[t]=i.VRq,i.Vx[t]>0?(i.Vx[t]=i.VT,i.Rq[t]=-i.VRp,i.Rr[t]=i.VRr):(i.Vx[t]=-i.VT,i.Rq[t]=i.VRp,i.Rr[t]=-i.VRr))},this.init_pars=function(t){i.X[t]>i.XMAX&&i.Vx[t]>0&&(i.VN=-i.Vx[t],i.VRq=-i.Rq[t],i.Vy[t]>0?(i.VT=i.Vy[t],i.VRp=i.Rp[t],i.VRr=-i.Rr[t]):(i.VT=-i.Vy[t],i.VRp=-i.Rp[t],i.VRr=i.Rr[t])),i.X[t]<i.XMIN&&i.Vx[t]<0&&(i.VN=i.Vx[t],i.VRq=i.Rq[t],i.Vy[t]>0?(i.VT=i.Vy[t],i.VRp=i.Rp[t],i.VRr=i.Rr[t]):(i.VT=-i.Vy[t],i.VRp=-i.Rp[t],i.VRr=-i.Rr[t])),i.Y[t]<i.YMIN&&i.Vy[t]<0&&(i.VN=i.Vy[t],i.VRq=-i.Rp[t],i.Vx[t]>0?(i.VT=i.Vx[t],i.VRp=-i.Rq[t],i.VRr=-i.Rr[t]):(i.VT=-i.Vx[t],i.VRp=i.Rq[t],i.VRr=i.Rr[t])),i.Y[t]>i.YMAX&&i.Vy[t]>0&&(i.VN=-i.Vy[t],i.VRq=i.Rp[t],i.Vx[t]>0?(i.VT=i.Vx[t],i.VRp=-i.Rq[t],i.VRr=i.Rr[t]):(i.VT=-i.Vx[t],i.VRp=i.Rq[t],i.VRr=-i.Rr[t]))},this.add_clef=function(t){var e=i.nb_max_clefs*t+i.nb_clefs[t];i.evts[e]=new I,i.evts[e].X=i.X[t],i.evts[e].Y=i.Y[t],i.evts[e].RAp=i.RAp[t],i.evts[e].RAq=i.RAq[t],i.evts[e].RAr=i.RAr[t],i.evts[e].time=i.date*i.pas;var s=i.nb_clefs,a=t,n=s[t]+1;s[a]=n,i.X0[t]=i.X[t],i.Y0[t]=i.Y[t],i.RAp0[t]=i.RAp[t],i.RAq0[t]=i.RAq[t],i.RAr0[t]=i.RAr[t]},this.choc_billes=function(t){var e=0,s=0,a=!1,n=NaN,o=NaN,h=NaN,r=NaN,l=NaN,c=NaN,p=NaN,u=NaN,d=NaN,f=NaN,m=NaN,b=NaN,g=NaN,v=NaN,R=NaN,V=NaN,M=NaN,w=NaN,P=NaN,y=NaN,_=!1,C=[];for(e=0;e<3;)C[e]=!1,e++;for(e=0;e<3;){if(!C[e]&&(a=!1,s=(e+1)%3,(n=(i.X[e]-i.X[s])*(i.X[e]-i.X[s])+(i.Y[e]-i.Y[s])*(i.Y[e]-i.Y[s]))<i.D*i.D&&(i.etat[e]!==i.ARRET||i.etat[s]!==i.ARRET)&&(i.Vx[e]-i.Vx[s])*(i.X[s]-i.X[e])+(i.Vy[e]-i.Vy[s])*(i.Y[s]-i.Y[e])>0&&(a=!0,_=!0,i.choc12||i.choc13||0!==e||(i.first_bille_choquee=s),0===e&&1===s&&(i.choc12=!0),2===e&&0===s&&(i.choc13=!0),t[0]=e,t[1]=s),a||(s=(e+2)%3,(n=(i.X[e]-i.X[s])*(i.X[e]-i.X[s])+(i.Y[e]-i.Y[s])*(i.Y[e]-i.Y[s]))<i.D*i.D&&(i.etat[e]!==i.ARRET||i.etat[s]!==i.ARRET)&&(i.Vx[e]-i.Vx[s])*(i.X[s]-i.X[e])+(i.Vy[e]-i.Vy[s])*(i.Y[s]-i.Y[e])>0&&(a=!0,_=!0,i.choc12||i.choc13||0!==e||(i.first_bille_choquee=s),1===e&&0===s&&(i.choc12=!0),0===e&&2===s&&(i.choc13=!0),t[0]=e,t[1]=s)),a)){i.add_clef(e),i.add_clef(s),C[e]=!0,i.etat[e]===i.RSG&&(i.Rp[e]=-i.Vy[e],i.Rq[e]=i.Vx[e]),i.etat[e]===i.QCQ&&(i.Rp[e]=-i.Vy[e]+i.VQy[e],i.Rq[e]=i.Vx[e]-i.VQx[e]),i.etat[e]===i.ARRET&&(i.Rp[e]=0,i.Rq[e]=0),C[s]=!0,i.etat[s]===i.RSG&&(i.Rp[s]=-i.Vy[s],i.Rq[s]=i.Vx[s]),i.etat[s]===i.QCQ&&(i.Rp[s]=-i.Vy[s]+i.VQy[s],i.Rq[s]=i.Vx[s]-i.VQx[s]),i.etat[s]===i.ARRET&&(i.Rp[s]=0,i.Rq[s]=0),h=(m=i.Vx[e]*(i.X[s]-i.X[e])+i.Vy[e]*(i.Y[s]-i.Y[e]))*(i.X[s]-i.X[e])/n,r=m*(i.Y[s]-i.Y[e])/n,l=i.Vx[e]-h,c=i.Vy[e]-r,p=(b=i.Vx[s]*(i.X[e]-i.X[s])+i.Vy[s]*(i.Y[e]-i.Y[s]))*(i.X[e]-i.X[s])/n,u=b*(i.Y[e]-i.Y[s])/n,d=i.Vx[s]-p,f=i.Vy[s]-u,v=h-p,R=r-u,i.intens=(v*v+R*R)/5,i.intens>1&&(i.intens=1),i.evts_son[i.nb_sons]=new X,i.evts_son[i.nb_sons].played=!1,i.evts_son[i.nb_sons].temps=i.date*i.pas,i.evts_son[i.nb_sons].intensite=i.intens,i.evts_son[i.nb_sons].type_choc=2;var x=i,S=i.nb_sons+1;x.nb_sons=S,g=h,h=p,p=g,p*=i.RendementChoc,h*=i.RendementChoc,g=r,r=u,u=g,u*=i.RendementChoc,r*=i.RendementChoc,i.Vx[e]=h+l,i.Vy[e]=r+c,i.VQx[e]=i.Vx[e]-i.Rq[e],i.VQy[e]=i.Vy[e]+i.Rp[e],i.etat[s]===i.ARRET&&(i.Vx[s]=.94*i.Vx[s],i.Vy[s]=.94*i.Vy[s],m/=o=Math.sqrt(n),m=Math.abs(m),P=i.fbille*m,V=Math.abs(i.Rp[e]*(i.Y[s]-i.Y[e])-i.Rq[e]*(i.X[s]-i.X[e]))/o,w=(i.Vx[e]*(i.Y[s]-i.Y[e])-i.Vy[e]*(i.X[s]-i.X[e]))/o-i.Rr[e],M=Math.abs(w)<1e-5?Math.PI/2:Math.abs(Math.atan(V/w)),y=(w>0?1:-1)*P*Math.cos(M),i.Rr[s]=2.5*y,i.Rr[e]=i.Rr[e]-2.5*y,d=y*(i.Y[s]-i.Y[e])/o,f=-y*(i.X[s]-i.X[e])/o),i.Vx[s]=p+d,i.Vy[s]=u+f,i.VQx[s]=i.Vx[s]-i.Rq[s],i.VQy[s]=i.Vy[s]+i.Rp[s],i.etat[s]=i.QCQ,i.etat[e]=i.QCQ}e++}return _},this.XMAX=e,this.YMAX=s,this.XMIN=-e,this.YMIN=-s,this.nb_max_clefs=1e4,this.nb_clefs=[],this.nb_clefs=[0,0,0],this.evts=[],this.nb_max_sons=50,this.nb_sons=0,this.evts_son=[],this.sorties=[],this.eff_s=[],this.etat=[],this.X0=[],this.Y0=[],this.X=[],this.Y=[],this.Xfin=[],this.Yfin=[],this.RAp=[],this.RAq=[],this.RAr=[],this.RAp0=[],this.RAq0=[],this.RAr0=[],this.RApfin=[],this.RAqfin=[],this.RArfin=[],this.Vx=[],this.Vy=[],this.Rp=[],this.Rq=[],this.Rr=[],this.VQx=[],this.VQy=[],this.etat=[],this.D=.06,this.R=.03,this.RendementChoc=.8,this.deltaclefRot=this.R*Math.PI/10,this.resolution=.01,this.done=!1,this.sorties=[0,0,0,7.5,7.5,7.5,16,16,16,33,32,23.5,52,43,31,72,53,35,86,60,38,100,69,44,108,79,53,120,90,60],this.eff_s=[-1.5,0,1.5,-1.5,.5,1.2,-1.3,.7,1.3,-.5,1.3,1.2,-.5,1.3,1.1,-.3,.8,1.2,0,.7,1.2,0,.5,1.5,-.6,.2,1.5,-.65,0,1.5]},B=function t(e,s,i,a,n,o,r){var l=this;Object(h.a)(this,t),this.getMesh=function(){return l.mesh},this.getPosition=function(){return Object.assign({},l.mesh.position)},this.getVisibility=function(){return l.mesh.visibility},this.updatePosition=function(t,e){l.mesh.position.x=t,l.mesh.position.z=e},this.updateRotation=function(t,e,s){var i=(t-l.RAp0)/.03,a=(e-l.RAq0)/.03,n=(s-l.RAr0)/.03;l.RAp0=t,l.RAq0=e,l.RAr0=s,l.mesh.rotate(b.Axis.X,-i,b.Space.WORLD),l.mesh.rotate(b.Axis.Y,-n,b.Space.WORLD),l.mesh.rotate(b.Axis.Z,-a,b.Space.WORLD)},this.isPotted=function(){return!l.mesh.visibility},this.pot=function(){l.mesh.visibility=!1},this.scene=e,this.mesh=b.Mesh.CreateSphere(s,30,i,this.scene),this.mesh.position.y=a.y,this.mesh.position.x=a.x,this.mesh.position.z=a.z,this.mesh.receiveShadows=!1,this.mesh.convertToUnIndexedMesh();var c=new b.StandardMaterial("redMat",this.scene);c.roughness=.3,c.reflectivityColor=new b.Vector3(1,1,1),c.diffuseTexture=new b.Texture(n+o,this.scene),c.reflectionTexture=new b.CubeTexture(n+"skybox/room",this.scene),c.reflectionFresnelParameters=new b.FresnelParameters,c.reflectionFresnelParameters.power=1,c.specularPower=500,c.freeze(),this.mesh.material=c,this.mesh.rotation.y=Math.PI*Math.random()*2,this.mesh.rotation.x=Math.PI*Math.random()*2,this.mesh.rotation.z=Math.PI*Math.random()*2,this.mesh.visibility=r,this.RAp0=0,this.RAq0=0,this.RAr0=0},z=function(t,e,s,i,a,n){return(i*a-e*a+t*n-s*n+e*s-t*i)/Math.sqrt(Math.pow(i-e,2)+Math.pow(s-t,2))},j=function(t,e,s,i){return[s-Math.sin(e)*t,i+Math.cos(e)*t]},k=function t(e,s,i,a){var n=this;Object(h.a)(this,t),this.getMesh=function(){return n.mesh},this.update=function(t,e){n.mesh.position=t,n.mesh.rotation=e,n.mesh.visibility=!0},this.animateHit=function(t,e,s){var i=n,a=20*s,o=[],h=Object.assign({},i.mesh.position),r=Object.assign({},h);r.y+=a*Math.sin(e),r.x+=a*Math.cos(e)*Math.cos(t),r.z+=a*Math.cos(e)*Math.sin(t);var l=Object.assign({},h);l.y+=-10*Math.sin(e),l.x+=-10*Math.cos(e)*Math.cos(t),l.z+=-10*Math.cos(e)*Math.sin(t),o.push({frame:0,value:h}),o.push({frame:50,value:r}),o.push({frame:60,value:l});var c=new b.Animation("tutoAnimation","position",60,b.Animation.ANIMATIONTYPE_VECTOR3);c.setKeys(o),i.mesh.animations.push(c),i.scene.beginAnimation(i.mesh,0,60,!1,1,function(){setTimeout(function(){i.mesh.visibility=!1},500),i.updatePreviewPath(!1)})},this.registerCollisions=function(t){n.collisionObjects=t},this.onBatCollide=function(t){n.callbackBatCollide=t},this.updatePreviewPath=function(t,e,s,i,a,o,h,r){var l,c=Object(m.a)(n.previewPathes);try{for(c.s();!(l=c.n()).done;){l.value.dispose()}}catch(S){c.e(S)}finally{c.f()}if(!1!==t){a+=Math.PI,a%=2*Math.PI;var p=o[0],u=o[1];if(0===a||a===2*Math.PI)p=e/2;else if(a>0&&a<Math.PI/2)for(;p<=e/2&&u<=e/4;)a<Math.PI/4?(p+=.5,u+=.5*Math.tan(a)):(u+=.5,p+=.5/Math.tan(a));else if(a===Math.PI/2)u=e/4;else if(a>Math.PI/2&&a<Math.PI)for(;p>=-e/2&&u<=e/4;)a>3*Math.PI/4?(p-=.5,u-=.5*Math.tan(a)):(u+=.5,p+=.5/Math.tan(a));else if(a===Math.PI)p=-e/2;else if(a>Math.PI&&a<3*Math.PI/2)for(;p>=-e/2&&u>=-e/4;)a<5*Math.PI/4?(p-=.5,u-=.5*Math.tan(a)):(u-=.5,p-=.5/Math.tan(a));else if(a===3*Math.PI/2)u=-e/4;else if(a>3*Math.PI/2&&a<2*Math.PI)for(;p<=e/2&&u>=-e/4;)a>7*Math.PI/4?(p+=.5,u+=.5*Math.tan(a)):(u-=.5,p-=.5/Math.tan(a));var d=n.checkOverlap(o[0],o[1],p,u,h,a);if(d.index>=0){var f=h[d.index],g=j(d.dist,a,f[0],f[1]);if((g[0]-o[0])/(p-o[0])>=0){p=g[0],u=g[1];var v=d.dist,R=Math.sqrt(Math.pow(i,2)-Math.pow(v,2)),V=Math.sqrt(Math.pow(p-o[0],2)+Math.pow(u-o[1],2));if(p+=(o[0]-p)*R/V,u+=(o[1]-u)*R/V,r){var M=[];M.push(new b.Vector3(f[0],i/2,f[1])),M.push(new b.Vector3(f[0]-2*(p-f[0]),i/2,f[1]-2*(u-f[1])));var w=new b.Mesh.CreateTube("tubeObjectBall",M,1,6,null,0,n.scene,!0,b.Mesh.FRONTSIDE);w.convertToFlatShadedMesh(),w.scaling.y=.1,w.material=n.mat,n.previewPathes.push(w);var P=[];P.push(new b.Vector3(p,i/2,u)),d.value<0?P.push(new b.Vector3(p+2*(f[1]-u),i/2,u-2*(f[0]-p))):P.push(new b.Vector3(p-2*(f[1]-u),i/2,u+2*(f[0]-p)));var y=new b.Mesh.CreateTube("tubeReflection",P,1,6,null,0,n.scene,!0,b.Mesh.FRONTSIDE);y.convertToFlatShadedMesh(),y.scaling.y=.1,y.material=n.mat,n.previewPathes.push(y)}"function"===typeof n.onOverlapEvent&&n.onOverlapEvent(d.index,d.value)}else"function"===typeof n.onOverlapEvent&&n.onOverlapEvent(-1)}else 0===a||a===2*Math.PI?p-=i/2:a>0&&a<Math.PI/2?a<Math.PI/4?(p-=i/2,u-=i/2*Math.tan(a)):(u-=i/2,p-=i/2/Math.tan(a)):a===Math.PI/2?u-=i/2:a>Math.PI/2&&a<Math.PI?a>3*Math.PI/4?(p+=i/2,u+=i/2*Math.tan(a)):(u-=i/2,p-=i/2/Math.tan(a)):a===Math.PI?p+=i/2:a>Math.PI&&a<3*Math.PI/2?a<5*Math.PI/4?(p+=i/2,u+=i/2*Math.tan(a)):(u+=i/2,p+=i/2/Math.tan(a)):a===3*Math.PI/2?u+=i/2:a>3*Math.PI/2&&a<2*Math.PI&&(a>7*Math.PI/4?(p-=i/2,u-=i/2*Math.tan(a)):(u+=i/2,p+=i/2/Math.tan(a))),"function"===typeof n.onOverlapEvent&&n.onOverlapEvent(d.index,d.value);var _=[];_.push(new b.Vector3(o[0],i/2,o[1])),_.push(new b.Vector3(p,i/2,u));var C=new b.Mesh.CreateTube("tubeCueball",_,1,6,null,0,n.scene,!0,b.Mesh.FRONTSIDE);C.convertToFlatShadedMesh(),C.scaling.y=.1,C.material=n.mat;var x=b.Mesh.CreateCylinder("cylinder",1,i,i,18,1,n.scene,!1,b.Mesh.DEFAULTSIDE);x.position.x=p,x.position.z=u,x.material=n.mat,n.previewPathes.push(C),n.previewPathes.push(x)}},this.checkOverlap=function(t,e,s,i,a,o){if(Array.isArray(a)){var h,r,l,c=1e4,p=-1;for(var u in a){var d=a[u];if(!0!==d[2]){var f=z(t,e,s,i,d[0],d[1]);if(Math.abs(f)<n.ballRadius+0){var m=j(f,o,d[0],d[1]);if(!1===(h=t,r=s,l=m[0],m[1],(l-h)/(r-h)>=0&&(l-h)/(r-h)<=1))continue;var b=Math.sqrt(Math.pow(t-d[0],2)+Math.pow(e-d[1],2));c>b&&(c=b,p=u)}}}if(p>=0){var g=z(t,e,s,i,a[p][0],a[p][1]),v=Math.round(g/n.ballRadius*100);return{dist:g,index:parseInt(p,10),value:v}}return{index:-1,value:0}}},this.scene=e,this.mesh=s,this.ballRadius=i,this.onOverlapEvent=a,this.mesh.receiveShadows=!1,this.mesh.position.y=50,this.mesh.position.z=90,this.previewPathes=[],this.prevCount=0;var o=this;this.collisionObjects=[],this.mat=new b.StandardMaterial("mat1",this.scene),this.mat.alpha=.3,this.mat.diffuseColor=new b.Color3(1,1,1),setInterval(function(){if(e){var t=!1,s=o.mesh;if(!1===s.visibility)return;var i,a=Object(m.a)(o.collisionObjects);try{for(a.s();!(i=a.n()).done;){var n=i.value;if(!0===n.visibility&&n.intersectsMesh(s,!0)){t=!0;break}}}catch(h){a.e(h)}finally{a.f()}!0===t&&"function"===typeof o.callbackBatCollide&&o.callbackBatCollide()}},1e3/60)},Q=function t(e,s,i){var a=this;Object(h.a)(this,t),this.getMeshes=function(){return a.meshes},this.scene=e,this.meshes=s;var n,o=Object(m.a)(this.meshes);try{for(o.s();!(n=o.n()).done;){var r=n.value;if(r.name.includes("wood")){var l=r.material.clone();r.material=l,r.material.reflectionTexture=new b.CubeTexture(i+"skybox/room-bottom",this.scene),r.material.reflectionFresnelParameters=new b.FresnelParameters,r.material.reflectionFresnelParameters.power=.6,r.material.roughness=.8,r.material.specularPower=500,r.material.specularColor=new b.Color3(.2,.2,.2)}"carpet"===r.name||r.name.includes("rail")}}catch(c){o.e(c)}finally{o.f()}},F=-.035,D=200,U=function(){function t(e,s,i){Object(h.a)(this,t),this.scene=e,this.canvas=s,this.cameras={standCam:void 0,topCam:void 0,targetCam:void 0},this.cameras.standCam=new b.UniversalCamera("UniversalCamera",new b.Vector3(0,100,-10),e),this.cameras.standCam.wheelPrecision=2,this.cameras.standCam.upperRadiusLimit=500,this.cameras.standCam.lowerRadiusLimit=100,this.cameras.targetCam=new b.ArcRotateCamera("Camera-Target",4.44,1.35,2*D,b.Vector3.Zero(),this.scene),this.cameras.targetCam.upperRadiusLimit=3*D,this.cameras.targetCam.lowerRadiusLimit=D/3,this.cameras.targetCam.upperBetaLimit=Math.PI/2+2*F,this.cameras.targetCam.lowerBetaLimit=0,this.cameras.topCam=new b.ArcRotateCamera("Camera-Top",-Math.PI/2,0,330,b.Vector3.Zero(),this.scene),this.cameras.topCam.fov=.5,this.cameras.topCam.upperBetaLimit=0,this.cameras.topCam.lowerBetaLimit=0,this.cameras.topCam.upperAlphaLimit=-Math.PI/2,this.cameras.topCam.lowerAlphaLimit=-Math.PI/2,this.cameras.topCam.upperRadiusLimit=600,this.cameras.topCam.lowerRadiusLimit=600,this.target={position:void 0,rotation:void 0,alpha:4.44,beta:1.35},this.changeView(this.currentView);var a=this;setInterval(function(){if(e){var t=a.cameras.targetCam.alpha,s=a.cameras.targetCam.beta;t%=2*Math.PI,a.target.alpha===t&&a.target.beta===s||(a.target.alpha=t,a.target.beta=s,t<0&&(t+=2*Math.PI),"function"===typeof i&&i(t,Math.PI/2-s+F))}},1e3/60)}return Object(r.a)(t,[{key:"changeView",value:function(t){this.currentView=t,"top"===t?(this.scene.activeCamera=this.cameras.topCam,this.cameras.topCam.attachControl(this.canvas),this.cameras.standCam.detachControl(this.canvas),this.cameras.targetCam.detachControl(this.cameras)):"stand"===t?(this.scene.activeCamera=this.cameras.standCam,this.cameras.standCam.attachControl(this.canvas),this.cameras.topCam.detachControl(this.canvas),this.cameras.targetCam.detachControl(this.canvas),this.standAction()):"targetting"===t&&(this.scene.activeCamera=this.cameras.targetCam,this.cameras.targetCam.attachControl(this.canvas),this.cameras.standCam.detachControl(this.canvas),this.cameras.topCam.detachControl(this.canvas))}},{key:"updateTarget",value:function(t,e){}},{key:"setFixedTargetToStandCamera",value:function(t){this.cameras.standCam.lockedTarget=t}},{key:"standAction",value:function(){var t=this.cameras.targetCam.alpha%(2*Math.PI),e=Object.assign({},this.cameras.targetCam.target),s=new b.Vector3(e.x+=300*Math.cos(t),100,e.z+=300*Math.sin(t));this.cameras.standCam.position=s}},{key:"enableControl",value:function(t){if(!1===t)switch(this.currentView){case"top":this.cameras.topCam.detachControl(this.canvas);break;case"stand":this.cameras.standCam.detachControl(this.canvas);break;case"targetting":this.cameras.targetCam.detachControl(this.canvas)}else switch(this.currentView){case"top":this.cameras.topCam.attachControl(this.canvas);break;case"stand":this.cameras.standCam.attachControl(this.canvas);break;case"targetting":this.cameras.targetCam.attachControl(this.canvas)}}}]),t}(),H=s(40),G=function t(e){var s=this;Object(h.a)(this,t),this.getFilePath=function(t){return s.assetStorePath+"sounds/"+t},this.playRolling=function(){},this.playHit=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;t>1&&(t=1),new H.Howl({src:[s.getFilePath("hitting.mp3")],volume:t}).play()},this.playBallCollision=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;t>1&&(t=1),new H.Howl({src:[s.getFilePath("ball-collision.mp3")],volume:t}).play()},this.playRailCollision=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;t>1&&(t=1),new H.Howl({src:[s.getFilePath("rail-collision.mp3")],volume:t}).play()},this.playPotting=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;t>1&&(t=1),new H.Howl({src:[s.getFilePath("potting.mp3")],volume:t}).play()},this.assetStorePath=e},W=function(t,e,s,i){for(;s-e>1;){var a=parseInt((e+s)/2,10);null!==t[a]&&t[a].hasOwnProperty("time")?t[a].time>i?s=a:e=a:s=a}return{index:e,isLast:null===t[s]}},Z=6.1,J=function(){function t(e,s,i,a,n,o,r,l,c){var p=this;Object(h.a)(this,t),this.getSavingData=function(t){},this.toggleMute=function(t){p.bMuted=t},this.toggleFollowCamera=function(t){p.bFollowCam=t,!0===t?p.cameras.setFixedTargetToStandCamera(p.objects.cueBallWhite.getMesh()):p.cameras.setFixedTargetToStandCamera(null)},this.drawBallPath=function(t,e){var s=p;p.bShowBallPath=t,p.ballPathVisible=e;var i=s.pathData;if(p.pathCueWhite&&p.pathCueWhite.dispose(),p.pathCueYellow&&p.pathCueYellow.dispose(),p.pathTargetBall&&p.pathTargetBall.dispose(),i&&0!==i.length&&t){if(!0===p.ballPathVisible[0]){for(var a=[],n=0;n<1e4;n++)i[n]&&a.push(new b.Vector3(w*i[n].X/p.size,p.ballRadius/2,w*i[n].Y/p.size));var o=new b.StandardMaterial("mat1",p.scene);o.alpha=.5,o.diffuseColor=new b.Color3(1,1,1),o.roughness=1,o.specularPower=1e3,o.specularColor=new b.Color3(.2,.2,.2),p.pathCueWhite=new b.Mesh.CreateTube("tube-white",a,1,6,null,0,p.scene,!0,b.Mesh.FRONTSIDE),p.pathCueWhite.convertToFlatShadedMesh(),p.pathCueWhite.scaling.y=.1,p.pathCueWhite.material=o}if(!0===p.ballPathVisible[1]){var h=[];for(n=1e4;n<2e4;n++)i[n]&&h.push(new b.Vector3(w*i[n].X/p.size,p.ballRadius/2,w*i[n].Y/p.size));var r=new b.StandardMaterial("mat1",p.scene);r.alpha=.5,r.diffuseColor=new b.Color3(.8,.8,0),r.roughness=1,r.specularPower=1e3,r.specularColor=new b.Color3(.2,.2,.2),p.pathCueYellow=new b.Mesh.CreateTube("tube-white",h,1,6,null,0,p.scene,!0,b.Mesh.FRONTSIDE),p.pathCueYellow.convertToFlatShadedMesh(),p.pathCueYellow.scaling.y=.1,p.pathCueYellow.material=r}if(!0===p.ballPathVisible[2]){var l=[];for(n=2e4;n<3e4;n++)i[n]&&l.push(new b.Vector3(w*i[n].X/p.size,p.ballRadius/2,w*i[n].Y/p.size));var c=new b.StandardMaterial("mat1",p.scene);c.alpha=.5,c.diffuseColor=new b.Color3(.8,0,0),c.roughness=1,c.specularPower=1e3,c.specularColor=new b.Color3(.2,.2,.2),p.pathTargetBall=new b.Mesh.CreateTube("tube-white",l,1,6,null,0,p.scene,!0,b.Mesh.FRONTSIDE),p.pathTargetBall.convertToFlatShadedMesh(),p.pathTargetBall.scaling.y=.1,p.pathTargetBall.material=c}}},this.configCameras=function(){var t=p;t.cameras=new U(t.scene,t.canvas,function(e,s){t.controlOptions.cueLine=e,t.controlOptions.cueAngle=s,"function"===typeof t.onControlOptionUpdate&&t.onControlOptionUpdate(t.controlOptions)}),t.changeView(t.currentView)},this.onOverlapped=function(t,e){t+=1,"function"===typeof p.onOverlapEvent&&(t>0?p.onOverlapEvent(L[t],e):p.onOverlapEvent(-1))},this.loadModels=function(){var t=p,e=p.assetStorePath;b.SceneLoader.ImportMesh("",e,V,t.scene,function(s){s[0].convertToUnIndexedMesh(),t.objects.bat=new k(t.scene,s[0],t.ballRadius,t.onOverlapped),t.shadowGenerator.getShadowMap().renderList.push(s[0]),b.SceneLoader.ImportMesh("",e,R,t.scene,function(s){t.objects.table=new Q(t.scene,s,e);var i,a=Object(m.a)(s);try{for(a.s();!(i=a.n()).done;){var n=i.value;if(n.freezeWorldMatrix(),console.log(n.name),n.name.includes("wood"))try{t.surroundLight1.includedOnlyMeshes.push(n),t.surroundLight2.includedOnlyMeshes.push(n)}catch(o){console.log(o)}n.name.includes("rail")||n.name.includes("wood")||n.name.includes("Buchaca")||"x3ds_Ligne02"===n.name?(n.receiveShadows=!1,t.shadowGenerator.getShadowMap().renderList.push(n)):n.name.includes("carpet")&&(n.receiveShadows=!0)}}catch(h){a.e(h)}finally{a.f()}t.configCueBalls(),t.updateBat(t.controlOptions),setTimeout(function(){"function"===typeof t.onSceneLoaded&&t.onSceneLoaded()},2e3)})})},this.updateControlOptions=function(t,e,s){p.controlOptions=t,void 0===p.t0&&p.updateBat(t)},this.toggleObjectif=function(t){p.visibleObjectif=t,p.updateBat(p.controlOptions)},this.updateBat=function(t,e){var s=t.cueLine,i=t.cueAngle,a=t.sideEnglish,n=t.topSpin,o=p.size,h=p.ballRadius,r=p.cameras,l=p.objects,c=l.bat,u=l.cueBallWhite,d=w*a/o,f=w*n/o;if(u){var m=u.getPosition();c.update({x:m.x-d*Math.sin(s)-f*Math.sin(i)*Math.cos(s),z:m.z+d*Math.cos(s)-f*Math.sin(i)*Math.sin(s),y:h/2+f*Math.cos(i)},{x:0,y:-s,z:Math.PI/2+i});var b=[];b.push([p.objects.cueBallYellow.getPosition().x,p.objects.cueBallYellow.getPosition().z]),b.push([p.objects.targetBall.getPosition().x,p.objects.targetBall.getPosition().z]),c.updatePreviewPath(!0,w,p.size,p.ballRadius,p.controlOptions.cueLine,[p.objects.cueBallWhite.getPosition().x,p.objects.cueBallWhite.getPosition().z],b,p.visibleObjectif),e||(r.updateTarget({x:m.x-d*Math.sin(s)-f*Math.sin(i)*Math.cos(s),z:m.z+d*Math.cos(s)-f*Math.sin(i)*Math.sin(s),y:h/2+f*Math.cos(i)},{x:0,y:-s,z:i}),r.changeView(p.currentView))}},this.generateReflectionMaterial=function(t,e){for(var s=p.scene,i=new b.ReflectionProbe("satelliteProbe"+t.name,512,s),a=0;a<e.length;a++)i.renderList.push(e[a]);t.material.reflectionTexture=i.cubeTexture,t.material.reflectivityColor=new b.Color3(.5,.5,.5),t.material.reflectionFresnelParameters=new b.FresnelParameters,t.material.reflectionFresnelParameters.bias=0,i.attachToMesh(t)},this.configCueBalls=function(){var t=p,e=p.assetStorePath,s=p.ballRadius,i=p.objects,a=i.table,n=i.bat,o=p.ballPositions,h=o.posCueBallWhite,r=o.posCueBallYellow,l=o.posTargetBall;t.objects.cueBallWhite=new B(t.scene,"cue-ball-white",s,{x:h.x,y:s/2,z:h.z},e,"cueball-white.jpg",!0),t.shadowGenerator.getShadowMap().renderList.push(t.objects.cueBallWhite.getMesh()),t.objects.cueBallYellow=new B(t.scene,"cue-ball-yellow",s,{x:r.x,y:s/2,z:r.z},e,"cueball-yellow.jpg",!0),t.shadowGenerator.getShadowMap().renderList.push(t.objects.cueBallYellow.getMesh()),t.objects.targetBall=new B(t.scene,"cue-ball-red",s,{x:l.x,y:s/2,z:l.z},e,"targetball.jpg",!0),t.shadowGenerator.getShadowMap().renderList.push(t.objects.targetBall.getMesh());var c=[];c.push(t.objects.cueBallYellow.getMesh(),t.objects.targetBall.getMesh());var u,d=Object(m.a)(a.getMeshes());try{for(d.s();!(u=d.n()).done;){var f=u.value;"rail-01"!==f.name&&"rail-02"!==f.name&&"rail-03"!==f.name&&"rail-04"!==f.name||c.push(f)}}catch(b){d.e(b)}finally{d.f()}n.registerCollisions(c),n.onBatCollide(function(){"function"===typeof t.onBatCollide&&t.onBatCollide()})},this.configGrids=function(){for(var t=p,e=[new b.Color4(.7,.7,.7,1),new b.Color4(.7,.7,.7,1)],s=0;s<15;s++){var i=[new b.Vector3(7*-w/16+s*w/16,1,-w/4),new b.Vector3(7*-w/16+s*w/16,1,w/4)];t.grids.push(b.MeshBuilder.CreateLines("lines",{points:i,colors:e},t.scene))}for(s=0;s<7;s++){var a=[new b.Vector3(-w/2,1,3*-w/16+s*w/16),new b.Vector3(w/2,1,3*-w/16+s*w/16)];t.grids.push(b.MeshBuilder.CreateLines("lines",{points:a,colors:e},t.scene))}p.toggleGrids(!1)},this.toggleGrids=function(t){for(var e=p.grids,s=0;s<e.length;s++)e[s].visibility=t},this.setOptimization=function(t){t.blockMaterialDirtyMechanism=!0,t.blockfreeActiveMeshesAndRenderingGroups=!0},this.configLightAndShadow=function(){var t=p,e=t.scene;t.scene.clearColor=new b.Color3(1,1,1),t.scene.ambientColor=new b.Color3(0,0,0),t.surroundLight1=new b.PointLight("surround-1",new b.Vector3(2*w,50,2*w),e),t.surroundLight1.intensity=10,t.surroundLight2=new b.PointLight("surround-2",new b.Vector3(2*-w,50,2*-w),e),t.surroundLight2.intensity=10;var s=new b.HemisphericLight("ambient1",new b.Vector3(0,1,0),e);s.intensity=.7,s.diffuse=new b.Color3(.9,.9,.9),s.specular=new b.Color3(0,0,0),s.groundColor=new b.Color3(0,0,0),t.directionalLight=new b.DirectionalLight("dir01",new b.Vector3(0,-1,0),e),t.directionalLight.intensity=3,t.directionalLight.position=new b.Vector3(0,200,0),t.shadowGenerator=new b.ShadowGenerator(1024,t.directionalLight),t.shadowGenerator.usePercentageCloserFiltering=!0,t.shadowGenerator.useBlurExponentialShadowMap=!0;var i=new b.Plane(0,1,0,0);i.normalize();var a=b.MeshBuilder.CreatePlane("floor",{height:1200,width:1200,sourcePlane:i,sideOrientation:b.Mesh.DOUBLESIDE},t.scene);a.position.y=-92;var n=new b.StandardMaterial("floor-mat",t.scene);n.diffuseTexture=new b.Texture(t.assetStorePath+"ground/ground-v.jpg",t.scene),a.material=n},this.initializeScene=function(t,e){var s=p;t.freezeActiveMeshes(),t.blockMaterialDirtyMechanism=!0,t.blockfreeActiveMeshesAndRenderingGroups=!0,s.scene=t,s.canvas=e,s.setOptimization(t),s.configLightAndShadow(),s.configCameras(),s.loadModels(),s.configGrids();var i=g.AdvancedDynamicTexture.CreateFullscreenUI("UI");s.positionLabel=new g.Rectangle,s.positionLabel.width="0px",s.positionLabel.height="70px",s.positionLabel.color="white",s.positionLabel.fontSize=12,s.positionLabel.thickness=2,s.positionLabel.background="#11111188",s.positionLabel.linkOffsetY=-50,i.addControl(s.positionLabel),s.positionLabelText=new g.TextBlock,s.positionLabelText.textHorizontalAlignment=g.Control.HORIZONTAL_ALIGNMENT_LEFT,s.positionLabelText.left="20px",s.positionLabelText.text="X: 1.24m\nY: -0.18m",s.positionLabelText.fontSize="20px",s.positionLabelText.textWrapping=!0,s.positionLabel.addControl(s.positionLabelText),s.scene.getEngine().stopRenderLoop(),setInterval(function(){requestAnimationFrame(function(){s.scene.render(),s.animateBalls()})},1e3/30),e.addEventListener("mousedown",s.onPointerDown),e.addEventListener("mouseup",s.onPointerUp),e.addEventListener("mousemove",s.onPointerMove),e.addEventListener("pointerdown",s.onPointerDown),e.addEventListener("pointerup",s.onPointerUp),e.addEventListener("pointermove",s.onPointerMove)},this.getGroundPosition=function(){var t=p.scene,e=t.pick(t.pointerX,t.pointerY,function(t){return"carpet"===t.name});return e.hit?e.pickedPoint:null},this.updateCueLineByPointer=function(t){var e=p;if("top"===e.currentView){var s=e.objects.cueBallWhite,i=e.getGroundPosition(t);if(i){var a=s.getPosition(),n=a.x,o=a.z,h=i.x-n,r=i.z-o,l=Math.atan(r/h);h>=0&&(l+=Math.PI),e.controlOptions.cueLine=l,"function"===typeof e.onControlOptionUpdate&&e.onControlOptionUpdate(e.controlOptions)}}},this.onPointerDown=function(t){var e=p,s=p.scene;if(e.pointerPressed=!0,0===t.button&&"targetting"!==e.currentView){var i=s.pick(s.pointerX,s.pointerY,function(t){return"cue-ball-white"===t.name||"cue-ball-yellow"===t.name||"cue-ball-red"===t.name});i.hit?(e.currentMesh=i.pickedMesh,e.positionLabel.width="130px",e.positionLabel.linkWithMesh(e.currentMesh),e.startingPoint=e.getGroundPosition(t),e.startingPoint&&setTimeout(function(){e.cameras.enableControl(!1)},0)):e.updateCueLineByPointer(t)}},this.onPointerUp=function(){var t=p,e=p.startingPoint;if(t.pointerPressed=!1,e)return t.updateBat(t.controlOptions),t.positionLabel.width="0px",t.positionLabel.linkWithMesh(null),t.cameras.enableControl(!0),t.startingPoint=null,void(t.currentMesh=null)},this.onPointerMove=function(t){var e=p,s=p.currentMesh;if(s){var i=e.getGroundPosition(t);if(!i)return;if(Math.abs(i.x)>=w/2-p.ballRadius/2||Math.abs(i.z)>=w/4-p.ballRadius/2)return;s.position=i,s.position.y=e.ballRadius/2,e.startingPoint=i;var a=i.x/w*e.size,n=i.z/w*e.size;a=Math.round(100*a)/100,n=Math.round(100*n)/100,e.positionLabelText.text="X: ".concat(a,"m\nY: ").concat(n,"m")}else e.pointerPressed&&e.updateCueLineByPointer(t)},this.moveAndRotateBall=function(t,e,s){var i,a=p,n=e-a.t0;n*=a.playbackSpeed?a.playbackSpeed:1;var o=W(a.pathData,1e4*s,1e4*(s+1)-1,n);if((i=o.index)>=0){var h=a.pathData[i],r=w*h.X/a.size,l=w*h.Y/a.size;isNaN(r)&&(r=0),isNaN(l)&&(l=0);var c=h.RAp,u=h.RAq,d=h.RAr;if(a.pathData[i+1]){var f=a.pathData[i+1],m=(n-h.time)/(f.time-h.time);r+=(w*f.X/a.size-r)*m,l+=(w*f.Y/a.size-l)*m,c+=(f.RAp-c)*m,u+=(f.RAq-u)*m,d+=(f.RAr-d)*m,isNaN(c)&&(c=0),isNaN(u)&&(u=0),isNaN(d)&&(d=0)}return t.updatePosition(r,l),t.updateRotation(c,u,d),!o.isLast}},this.animateBalls=function(){var t=p,e=p.objects,s=e.cueBallWhite,i=e.cueBallYellow,a=e.targetBall;if(t.pathData&&0!==t.pathData.length&&void 0!==t.t0)if(!0!==t.bPaused){var n=(new Date).getTime()/1e3,o=p.moveAndRotateBall(s,n,0),h=p.moveAndRotateBall(i,n,1),r=p.moveAndRotateBall(a,n,2);if(!1===o&&!1===h&&!1===r)return t.t0=void 0,t.bPaused=!1,t.cameras.setFixedTargetToStandCamera(null),void t.updateBat(t.controlOptions);if(!t.bMuted){var l=n-t.t0;l*=t.playbackSpeed?t.playbackSpeed:1;for(var c=0;c<t.soundData.length;c++){var u=t.soundData[c];if(null!==u&&(t.soundData[c+1]&&u.temps<l&&t.soundData[c+1].temps>l&&!1===u.played))switch(u.played=!0,u.type_choc){case 1:t.sounds.playHit(u.intensite);break;case 2:t.sounds.playBallCollision(u.intensite);break;case 3:t.sounds.playRailCollision(u.intensite);break;case 4:t.sounds.playPotting(u.intensite)}}}}else console.log("paused")},this.getSimulationResult=function(t){var e=p;t||(t=p.controlOptions);var s=p.objects,i=s.cueBallWhite,a=s.cueBallYellow,n=s.targetBall;return e.simul.Calcul({Xinit:[e.size*i.getPosition().x/w,e.size*a.getPosition().x/w,e.size*n.getPosition().x/w],Yinit:[e.size*i.getPosition().z/w,e.size*a.getPosition().z/w,e.size*n.getPosition().z/w],RApInit:[0,0,0],RAqInit:[0,0,0],RArInit:[0,0,0],el:t.sideEnglish,er:t.topSpin,alphaQ:t.cueAngle,betaQ:t.cueLine,Vqueue:t.speed})},this.playSimulation=function(t){if(!0===p.bPaused)return console.log("resume"),p.bPaused=!1,void(p.t0+=(new Date).getTime()/1e3-p.pausedTime);if(!p.t0){var e=p;e.playbackSpeed=t;var s=p.controlOptions,i=p.objects.bat,a=e.getSimulationResult();i.animateHit(s.cueLine,s.cueAngle,s.speed),setTimeout(function(){a&&0!==a.length&&(e.pathData=a.data,e.soundData=a.sounds,e.drawBallPath(e.bShowBallPath,e.ballPathVisible),e.bMuted||e.sounds.playHit(),e.t0=(new Date).getTime()/1e3,e.bPaused=!1,e.cameras.changeView("stand"),!0===e.bFollowCam?e.cameras.setFixedTargetToStandCamera(e.objects.cueBallWhite.getMesh()):e.cameras.setFixedTargetToStandCamera(null))},850)}},this.getStatus=function(){var t=p.objects,e=t.cueBallWhite,s=t.cueBallYellow,i=t.targetBall;return{isPlaying:!!p.t0,paused:p.bPaused,posCueBallWhite:{x:e.getPosition().x/w*p.size,z:e.getPosition().z/w*p.size},posCueBallYellow:{x:s.getPosition().x/w*p.size,z:s.getPosition().z/w*p.size},posTargetBall:{x:i.getPosition().x/w*p.size,z:i.getPosition().z/w*p.size}}},this.pauseSimulation=function(){!0!==p.bPaused&&(p.bPaused=!0,p.pausedTime=(new Date).getTime()/1e3)},this.resetBallPoints=function(t){if(t){p.t0=void 0,p.bPaused=!1,p.pathCueWhite&&p.pathCueWhite.dispose(),p.pathCueYellow&&p.pathCueYellow.dispose(),p.pathTargetBall&&p.pathTargetBall.dispose(),p.pathData=[];var e=p.objects,s=e.cueBallWhite,i=e.cueBallYellow,a=e.targetBall;s.updatePosition(t.posCueBallWhite.x/p.size*w,t.posCueBallWhite.z/p.size*w),i.updatePosition(t.posCueBallYellow.x/p.size*w,t.posCueBallYellow.z/p.size*w),a.updatePosition(t.posTargetBall.x/p.size*w,t.posTargetBall.z/p.size*w)}},this.scene=void 0,this.canvas=void 0,this.size=e,this.onControlOptionUpdate=o,this.onBatCollide=r,this.onOverlapEvent=l,this.onSceneLoaded=c,this.ballRadius=w*Z/(100*this.size),this.assetStorePath=s,this.initBallPosition=a,this.ballPositions={posCueBallWhite:{x:w*a.posCueBallWhite.x/e,z:w*a.posCueBallWhite.z/e},posCueBallYellow:{x:w*a.posCueBallYellow.x/e,z:w*a.posCueBallYellow.z/e},posTargetBall:{x:w*a.posTargetBall.x/e,z:w*a.posTargetBall.z/e}},this.currentView=i,this.cameras=void 0,this.objects={table:void 0,bat:void 0,cueBallWhite:void 0,cueBallYellow:void 0,targetBall:void 0,batContactLine:void 0,batLookatPoint:void 0,directionLine:void 0},this.controlOptions=n,this.grids=[],this.pathCueWhite=void 0,this.pathCueYellow=void 0,this.pathTargetBall=void 0,this.simul=new q(1.39,.679),this.bShowBallPath=!1,this.bMuted=!1,this.bPaused=!1,this.bFollowCam=!0,this.sounds=new G(this.assetStorePath),this.pointerPressed=!1,this.ballPathVisible=[!0,!0,!0],this.visibleObjectif=!0}return Object(r.a)(t,[{key:"changeView",value:function(t){this.currentView=t,this.cameras.changeView(t)}}]),t}(),K=s(8),$=s(7),tt=s(53);function et(){var t=Object(d.a)(["\n"]);return et=function(){return t},t}var st=Object(K.css)(et()),it={width:"100%",height:"100%"},at=function(t){Object(l.a)(s,t);var e=Object(c.a)(s);function s(t){var i;Object(h.a)(this,s),(i=e.call(this,t)).takeScreenshot=function(t){i.board.getSavingData(t)},i.componentWillReceiveProps=function(t){i.board.updateControlOptions({cueLine:t.cueLine,cueAngle:t.cueAngle,sideEnglish:t.sideEnglish,topSpin:t.topSpin,speed:t.speed})},i.meshPicked=function(t){},i.drawBallPath=function(t,e){i.board.drawBallPath(t,e)},i.toggleMute=function(t){i.board.toggleMute(t)},i.onSceneMount=function(t){var e=t.canvas,s=t.scene;i.board.initializeScene(s,e),window.addEventListener("resize",function(){s.getEngine().resize()}),$.isMobile&&s.getEngine().setHardwareScalingLevel(.5),s.getEngine().resize()},i.toggleGrids=function(t){i.board.toggleGrids(t)},i.getStatus=function(){return i.board.getStatus()},i.playSimulation=function(t){i.board.playSimulation(t)},i.pauseSimulation=function(){i.board.pauseSimulation()},i.resetBallPoints=function(t){i.board.resetBallPoints(t)},i.updateControlOptions=function(t,e){i.board.updateControlOptions(t,e)},i.toggleObjectif=function(t){i.board.toggleObjectif(t)},i.toggleFollowCamera=function(t){i.board.toggleFollowCamera(t)},i.state={showPath:!1,isLoadingScene:!0};var n=Object(u.a)(i);return i.board=new J(i.props.size,i.props.assetStorePath,i.props.currentView,{posCueBallWhite:{x:i.props.posCueBallWhite.x,z:i.props.posCueBallWhite.z},posCueBallYellow:{x:i.props.posCueBallYellow.x,z:i.props.posCueBallYellow.z},posTargetBall:{x:i.props.posTargetBall.x,z:i.props.posTargetBall.z}},{cueLine:i.props.cueLine,cueAngle:i.props.cueAngle,sideEnglish:i.props.sideEnglish,topSpin:i.props.topSpin,speed:i.props.speed},function(t){n.props.onControlOptionUpdate(t)},function(){var t=Object.assign({},i.props);t.cueAngle<Math.PI/180*89&&(t.cueAngle+=Math.PI/180,i.props.onControlOptionUpdate(t))},function(t,e){i.props.onOverlapEvent(t,e)},function(){i.setState({isLoadingScene:!1})}),i.simulatorDom=new a.a.createRef,i}return Object(r.a)(s,[{key:"changeView",value:function(t){this.board.changeView(t)}},{key:"render",value:function(){var t=this.state.isLoadingScene;return a.a.createElement("div",{style:it},a.a.createElement(f.a,{canvasId:"carom-simulator-canvas",antialias:!0},a.a.createElement(f.b,{onMeshPicked:this.meshPicked,onSceneMount:this.onSceneMount})),!0===t?a.a.createElement("div",{className:"loading-icon-container"},a.a.createElement(tt.ClipLoader,{css:st,sizeUnit:"px",size:80,color:"#f0f0f0",loading:t})):null)}}]),s}(a.a.Component),nt=s(13),ot=s(139),ht=s(11),rt=function(t){Object(l.a)(s,t);var e=Object(c.a)(s);function s(t){var i;return Object(h.a)(this,s),(i=e.call(this,t)).pointerDownEvent=function(){var t=i.props.onPress;"down"!==i.state.mouseState&&i.setState({mouseState:"down"},function(){i.timeoutId=setTimeout(function(){i.timerId=setInterval(function(){"down"===i.state.mouseState?"function"===typeof t&&t():clearTimeout(i.timerId)},10)},1e3)})},i.pointerUpEvent=function(){i.setState({mouseState:"up"},function(){clearTimeout(i.timerId),clearTimeout(i.timeoutId)})},i.pointerLeaveEvent=function(){i.setState({mouseState:"up"},function(){clearTimeout(i.timerId),clearTimeout(i.timeoutId)})},i.state={mouseState:"up"},i.timerId=-1,i.timeoutId=-1,i}return Object(r.a)(s,[{key:"render",value:function(){var t=this.props,e=t.icon,s=t.className,i=t.onPress;return a.a.createElement(nt.a,{icon:e,className:s,onClick:i,onMouseDown:this.pointerDownEvent,onMouseUp:this.pointerUpEvent,onMouseLeave:this.pointerLeaveEvent,onPointerDown:this.pointerDownEvent,onPointerUp:this.pointerUpEvent,onPointerLeave:this.pointerLeaveEvent})}}]),s}(a.a.Component),lt=s(335),ct=(s(182),s(183),"/static/images/balls/cue_ball_big.png"),pt="/static/images/balls/pool_ball_1.png",ut="/static/images/balls/pool_ball_2.png",dt="/static/images/balls/pool_ball_3.png",ft="/static/images/balls/pool_ball_4.png",mt="/static/images/balls/pool_ball_5.png",bt="/static/images/balls/pool_ball_6.png",gt="/static/images/balls/pool_ball_7.png",vt="/static/images/balls/pool_ball_8.png",Rt="/static/images/balls/pool_ball_9.png",Vt="/static/images/balls/pool_ball_10.png",Mt="/static/images/balls/pool_ball_11.png",wt="/static/images/balls/pool_ball_12.png",Pt="/static/images/balls/pool_ball_13.png",yt="/static/images/balls/pool_ball_14.png",_t="/static/images/balls/pool_ball_15.png",Ct=52.5,xt=15,St=function(t){switch(t){case 1:return pt;case 2:return ut;case 3:return dt;case 4:return ft;case 5:return mt;case 6:return bt;case 7:return gt;case 8:return vt;case 9:return Rt;case 10:return Vt;case 11:return Mt;case 12:return wt;case 13:return Pt;case 14:return yt;case 15:return _t;case 21:return"/static/images/balls/carom_ball_yellow.png";case 22:return"/static/images/balls/carom_ball_red.png";default:return ct}},Nt=function(t){Object(l.a)(s,t);var e=Object(c.a)(s);function s(t){var i;return Object(h.a)(this,s),(i=e.call(this,t)).checkRadialBounding=function(t,e){return Math.sqrt(Math.pow(t,2)+Math.pow(e,2))<xt},i.updateTipPosition=function(t,e){var s=$.isMobile?90:130,a=t.clientX,n=t.clientY,o=i.domBallImage.current.getBoundingClientRect();a-=o.x,n-=o.y;var h=(a/s-.5)*Ct;h=Math.round(10*h)/10;var r=(.5-n/s)*Ct;if(r=Math.round(10*r)/10,i.checkRadialBounding(h,r)){var l={cueLine:i.state.cueLine,cueAngle:i.state.cueAngle,sideEnglish:i.state.sideEnglish,topSpin:i.state.topSpin,speed:i.state.speed};i.setState({tipPositionLeft:a,tipPositionTop:n}),l.sideEnglish=h,l.topSpin=r,i.dispatchUpdateEvent(l)}else{a-=s/2,n-=s/2;var c=Math.sqrt(a*a+n*n);h=xt*Math.cos(Math.acos(a/c)),h=Math.round(10*h)/10,r=xt*Math.sin(-Math.asin(n/c)),r=Math.round(10*r)/10;var p=(h/Ct+.5)*s,u=(.5-r/Ct)*s,d={cueLine:i.state.cueLine,cueAngle:i.state.cueAngle,sideEnglish:i.state.sideEnglish,topSpin:i.state.topSpin,speed:i.state.speed};i.setState({tipPositionLeft:p,tipPositionTop:u}),d.sideEnglish=h,d.topSpin=r,i.dispatchUpdateEvent(d)}},i.onBallPointerDown=function(t){i.setState({isPointerDown:!0}),i.updateTipPosition(t,!1)},i.onBallPointerUp=function(t){i.setState({isPointerDown:!1}),i.updateTipPosition(t,!0)},i.onBallPointerMove=function(t){i.state.isPointerDown&&i.updateTipPosition(t,!1)},i.dispatchUpdateEvent=function(t,e){t||(t=i.state);var s=t;s.cueLine=Math.PI*s.cueLine/180,s.cueAngle=Math.PI*s.cueAngle/180,s.sideEnglish/=1e3,s.topSpin/=1e3,s.speed/=100,i.props.onControlOptionsUpdated(s,e)},i.componentWillReceiveProps=function(t){i.setState({cueLine:Math.round(1800*t.cueLine/Math.PI)/10,cueAngle:Math.round(1800*t.cueAngle/Math.PI)/10,sideEnglish:Math.round(1e4*t.sideEnglish)/10,topSpin:Math.round(1e4*t.topSpin)/10,speed:Math.round(100*t.speed)})},i.onInputSliderUpdated=function(t,e){var s=Object.assign({},i.state);s[t]=parseFloat(e),"sideEnglish"===t||"topSpin"===t?i.checkRadialBounding(s.sideEnglish,s.topSpin)&&i.dispatchUpdateEvent(s,!1):i.dispatchUpdateEvent(s,!0)},i.overlap=function(t,e){i.setState({overlap:{index:t,value:e}})},i.drawOverlap=function(t,e){var s=i.state,n=s.tipPositionLeft,o=s.tipPositionTop,h=s.isPointerDown,r=i.state,l=r.sideEnglish,c=r.topSpin,p=$.isMobile?90:130,u=0,d=0;h?(d=n-11,u=o-11):(d=(l/Ct+.5)*p-11,u=(.5-c/Ct)*p-11);var f;f=p*(100-e)/100;var m="";return m=e<0?100+e+"% R":100-e+"% L",a.a.createElement("div",{className:"overlap-visualizer"},a.a.createElement("div",{style:{textAlign:"center",fontSize:"16px",color:"white",minHeight:"20px"}},t>0?a.a.createElement("span",null,"overlap: "+m):null),a.a.createElement("div",{className:"ball-container"},t>0?a.a.createElement("img",{alt:"alt",src:St(t),className:"cue-ball",style:{left:p+"px"}}):null,a.a.createElement("div",{style:{width:p+"px",height:p+"px",marginLeft:t>0?f:p+"px",position:"relative"}},a.a.createElement("img",{alt:"alt",src:ct,ref:i.domBallImage,className:"cue-ball",draggable:!1,onMouseUp:i.onBallPointerUp,onMouseMove:i.onBallPointerMove,onMouseDown:i.onBallPointerDown,onPointerUp:i.onBallPointerUp,onPointerMove:i.onBallPointerMove,onPointerDown:i.onBallPointerDown}),a.a.createElement("div",{className:"tip-position",style:{top:u,left:d}}))))},i.enterFullScreen=function(){var t=document.getElementById("simulator-container");t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),document.fullScreenElement&&null!==document.fullScreenElement||!document.mozFullScreen&&!document.webkitIsFullScreen?t.requestFullScreen?t.requestFullScreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen&&t.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()},i.state={cueLine:Math.round(1800*i.props.cueLine/Math.PI)/10,cueAngle:Math.round(1800*i.props.cueAngle/Math.PI)/10,sideEnglish:Math.round(1e4*i.props.sideEnglish)/10,topSpin:Math.round(1e4*i.props.topSpin)/10,speed:Math.round(100*i.props.speed),tipPositionLeft:0,tipPositionTop:0,isPointerDown:!1,bCommonControllersOpened:!1,cameraType:"top",overlap:{index:-1,value:0},playbackSpeed:1,finetuneVisible:!0},i.domBallImage=new a.a.createRef,i}return Object(r.a)(s,[{key:"render",value:function(){var t=this,e=this.state,s=e.cueLine,i=e.cueAngle,n=e.sideEnglish,o=e.topSpin,h=e.speed,r=e.playbackSpeed,l=e.finetuneVisible,c=this.props,p=c.currentView,u=c.showGrid,d=c.showPath,f=c.muted,m=c.hasPrevHit,b=c.hasNextHit,g=c.bFollowCamera,v=this.state.bCommonControllersOpened,R=this.state.overlap,V="toggle-btn",M="toggle-btn",w="toggle-btn";!0===u&&(V+=" active"),!0===d&&(M+=" active"),!1===f&&(w+=" active");var P="common-controller-container";v&&(P+=" opened");var y="play-controller",_="play-controller";return m||(y+=" disabled"),b||(_+=" disabled"),a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"controller-collection"},a.a.createElement("div",{className:P+($.isMobile?" mobile-view":"")},a.a.createElement(nt.a,{"data-tip":"Common Settings","data-tip-disable":!0===$.isMobile,icon:ht.f,className:"big-icon",onClick:function(){t.setState({bCommonControllersOpened:!v})}}),a.a.createElement(nt.a,{className:V,icon:ht.r,onClick:function(){t.props.onToggleShowGrid(!u)}}),a.a.createElement(nt.a,{className:M,icon:ht.g,onClick:function(){t.props.onToggleShowPath(!d)}}),a.a.createElement(nt.a,{className:w,icon:f?ht.t:ht.u,onClick:function(){t.props.onToggleVolume(!f)}}),a.a.createElement(nt.a,{className:"toggle-btn active",icon:ht.i,onClick:this.enterFullScreen})),l?a.a.createElement("div",{className:"finetune-control-panel"+($.isMobile?" mobile-view":"")},a.a.createElement("div",{style:{pointerEvents:"none"}},a.a.createElement(rt,{icon:ht.d,className:"direction-icon",onPress:function(){var e=t.state.cueAngle;if(e<=88.5){e+=.3,e=Math.round(10*e)/10;var s=t.state;s.cueAngle=e,t.dispatchUpdateEvent(s,!0)}}})),a.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:"none"}},a.a.createElement(rt,{icon:ht.b,className:"direction-icon",onPress:function(){var e=t.state.cueLine;(e+=.3)<0?e+=360:e>=360&&(e-=360),e=Math.round(10*e)/10;var s=t.state;s.cueLine=e,t.dispatchUpdateEvent(s,!0)}}),this.drawOverlap(R.index,R.value),a.a.createElement(rt,{icon:ht.c,className:"direction-icon",onPress:function(){var e=t.state.cueLine;(e-=.3)<0?e+=360:e>=360&&(e-=360),e=Math.round(10*e)/10;var s=t.state;s.cueLine=e,t.dispatchUpdateEvent(s,!0)}})),a.a.createElement("div",{style:{pointerEvents:"none"}},a.a.createElement(rt,{icon:ht.a,className:"direction-icon",onPress:function(){var e=t.state.cueAngle;if(e>=2.5){e-=.3,e=Math.round(10*e)/10;var s=t.state;s.cueAngle=e,t.dispatchUpdateEvent(s,!0)}}}))):null,a.a.createElement("div",{className:"speed-slider-container"+($.isMobile?" mobile-view":"")},a.a.createElement(lt.a,{vertical:!0,min:0,max:450,value:h,onChange:function(e){t.onInputSliderUpdated("speed",e)},renderMark:function(t){return a.a.createElement("span",null,t,"cm/s")},barClassName:"speed-slider-bar",handleClassName:"speed-slider-handle"})),!1===$.isMobile?a.a.createElement(ot.a,null):null),a.a.createElement("div",{className:"bottom-container"+($.isMobile?" mobile-view":"")},a.a.createElement("div",{className:"extra-container"},a.a.createElement("div",{className:"view-selector-container"},a.a.createElement("img",{alt:"alt",className:"camera-type ".concat("top"===p?"active":""),src:"/static/images/balls/icon_top_view.png",onClick:function(){return t.props.cameraTypeChanged("top")}}),"stand"===p?a.a.createElement("img",{alt:"alt",className:"camera-type ".concat("stand"===p?"active":""),src:"/static/images/balls/icon_target_view.png",onClick:function(){return t.props.cameraTypeChanged("targetting")}}):a.a.createElement("img",{alt:"alt",className:"camera-type ".concat("targetting"===p?"active":""),src:"/static/images/balls/icon_stand_view.png",onClick:function(){return t.props.cameraTypeChanged("stand")}})),a.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"}},a.a.createElement("img",{alt:"alt",src:"/static/images/balls/icon_follow_cam.png",className:"camera-type ".concat(g?"active":""),onClick:this.props.onToggleFollowCam}),a.a.createElement(nt.a,{icon:ht.n,className:"toggle-btn big ".concat(l?"active":""),"data-tip":"".concat(l?"Hide":"Show"," Finetune"),"data-tip-disable":!0===$.isMobile,onClick:function(){return t.setState({finetuneVisible:!l})}}))),a.a.createElement("div",{className:"angle-tip-label-container"},a.a.createElement("div",{className:"angle-section"},a.a.createElement(nt.a,{icon:ht.q,className:"play-controller"}),a.a.createElement("span",{className:"label"},"Cue Line: ",s,a.a.createElement("sup",null,"o")),a.a.createElement("span",{className:"label"},"Cue Angle: ",i,a.a.createElement("sup",null,"o"))),a.a.createElement("div",{className:"tip-section"},a.a.createElement(nt.a,{icon:ht.h,className:"play-controller"}),a.a.createElement("span",{className:"label"},"Side English: ",n,"mm"),a.a.createElement("span",{className:"label"},"Top Spin: ",o,"mm"))),a.a.createElement("div",{className:"play-controller-section"},a.a.createElement("div",{className:"playback-speed-container"},a.a.createElement(nt.a,{"data-tip":"Playback Speed","data-tip-disable":!0===$.isMobile,className:"play-controller",icon:ht.j}),[.1,.25,.5,.75,1,1.5,2,3,5].map(function(e,s){return a.a.createElement("div",{key:s,className:"playback-speed-option"+(r===e?" active":""),onClick:function(){t.setState({playbackSpeed:e})}},e)})),a.a.createElement("div",{className:"play-controller-container"},a.a.createElement("span",{className:"label",style:{minWidth:70}},h,"cm/s"),a.a.createElement(nt.a,{"data-tip":"Randomize","data-tip-disable":!0===$.isMobile,className:"play-controller",icon:ht.m,onClick:this.props.onNewSequence}),a.a.createElement(nt.a,{"data-tip":"Reload Sequence","data-tip-disable":!0===$.isMobile,className:"play-controller",icon:ht.s,onClick:this.props.onResetPressed}),a.a.createElement(nt.a,{"data-tip":"Prev Shot","data-tip-disable":!0===$.isMobile,className:y,icon:ht.o,onClick:this.props.onUndoPressed}),a.a.createElement(nt.a,{"data-tip":"Pause","data-tip-disable":!0===$.isMobile,className:"play-controller",icon:ht.k,onClick:this.props.onPausePressed}),a.a.createElement(nt.a,{"data-tip":"Play","data-tip-disable":!0===$.isMobile,className:"play-controller",icon:ht.l,onClick:function(){t.setState({bCommonControllersOpened:!1}),t.props.onPlayPressed(r)}}),a.a.createElement(nt.a,{"data-tip":"Next Shot","data-tip-disable":!0===$.isMobile,className:_,icon:ht.p,onClick:this.props.onRedoPressed})))))}}]),s}(a.a.Component),Tt=s(91),Et=s.n(Tt),At=(s(331),function(t){Object(l.a)(s,t);var e=Object(c.a)(s);function s(t){var i;return Object(h.a)(this,s),(i=e.call(this,t)).state={showDialog:!1},i}return Object(r.a)(s,[{key:"render",value:function(){var t=this,e=this.state.showDialog,s=this.props,i=s.objectif,n=s.ballPathVisible,o=s.ballTextures;return a.a.createElement("div",{className:"ball-path-controller ".concat(e?"opened":""," ").concat($.isMobile?" mobile-view":"")},a.a.createElement("div",{className:"path-container"},a.a.createElement("label",{className:"switch-element"},a.a.createElement(Et.a,{checked:i,onChange:function(){return t.props.onUpdateObjectif(!i)},onColor:"#86d3ff",onHandleColor:"#2693e6",handleDiameter:30,uncheckedIcon:!1,checkedIcon:!1,boxShadow:"0px 1px 5px rgba(0, 0, 0, 0.6)",activeBoxShadow:"0px 0px 1px 10px rgba(0, 0, 0, 0.2)",height:20,width:48,className:"react-switch",id:"material-switch"}),a.a.createElement("span",null,"Objectif")),a.a.createElement("h4",null,"Ball Pathes"),Array.isArray(n)&&n.map(function(e,s){return a.a.createElement("label",{className:"switch-element",key:s},a.a.createElement(Et.a,{checked:e,onChange:function(){t.props.onToggleBallPathVisible(s)},onColor:"#86d3ff",onHandleColor:"#2693e6",handleDiameter:30,uncheckedIcon:!1,checkedIcon:!1,boxShadow:"0px 1px 5px rgba(0, 0, 0, 0.6)",activeBoxShadow:"0px 0px 1px 10px rgba(0, 0, 0, 0.2)",height:20,width:48,className:"react-switch",id:"material-switch"}),a.a.createElement("img",{alt:"alt",src:o[s],className:"ball-texture"}))})),a.a.createElement(nt.a,{"data-tip":"Ball Pathes","data-tip-disable":!0===$.isMobile,className:"open-ball-path-icon",icon:ht.e,onClick:function(){t.setState({showDialog:!e})}}))}}]),s}(a.a.Component)),Ot=(a.a.Component,s(137),function(){function t(e,s){Object(h.a)(this,t),this.b1=-.96912,this.b3=.76856,this.RSG=1,this.RTROU=.0233,this.fgpas=.00225,this.frpas=63e-6,this.EPSILON_COIN=.8,this.XTROU2=0,this.QCQ=2,this.Rfppas=135e-6,this.f1=.375,this.f2=.61,this.fbille=.075,this.Rfp=.225,this.pas=5e-4,this.fp1=.3,this.ARRET=0,this.angle_poche_coin=.890118,this.fg=3.75,this.YTROU=.652,this.angle_poche_centrale=-.244346,this.fr=.09,this.XC=-1.1867,this.EMPOCHEE=4,this.XE=-.0633,this.XF=-.03333,this.XB=-1.2467,this.XA=-1.27,this.delta_fgpas=.00786,this.YB=.57055,this.YC=.635,this.YF=.635,this.YA=.55167,this.YTROU2=.6883,this.YE=.635,this.XTROU=-1.2867,this.EPSILON=.86,this.TSP=3,this.a3=4.0108,this.a1=-1.235,this.a2=-.80978;var i=0;for(this.XD=this.XC-.03*Math.sin(39*Math.PI/180),this.YD=this.YC-.03*Math.cos(39*Math.PI/180),this.b2=this.YD-this.a2*this.XD,this.XMAX=e,this.YMAX=s,this.XMIN=-e,this.YMIN=-s,this.nb_max_clefs=1e4,this.nb_clefs=[],i=0;i<16;)this.nb_clefs[i]=0,i++;this.evts=[],this.nb_max_sons=100,this.nb_sons=0,this.evts_son=[],this.sorties=[],this.eff_s=[],this.etat=[],this.X0=[],this.Y0=[],this.X=[],this.Y=[],this.Xfin=[],this.Yfin=[],this.RAp=[],this.RAq=[],this.RAr=[],this.RAp0=[],this.RAq0=[],this.RAr0=[],this.RApfin=[],this.RAqfin=[],this.RArfin=[],this.empochee_fin=[],this.Vx=[],this.Vy=[],this.Rp=[],this.Rq=[],this.Rr=[],this.VQx=[],this.VQy=[],this.etat=[],this.time_empochee=[],this.immobile=[],this.date_arret=[],this.D=.06,this.R=.03,this.RendementChoc=.8,this.deltaclefRot=this.R*Math.PI/10,this.resolution=.01,this.done=!1,this.sorties[0]=0,this.sorties[1]=0,this.sorties[2]=0,this.sorties[3]=7.5,this.sorties[4]=7.5,this.sorties[5]=7.5,this.sorties[6]=16,this.sorties[7]=16,this.sorties[8]=16,this.sorties[9]=33,this.sorties[10]=32,this.sorties[11]=23.5,this.sorties[12]=52,this.sorties[13]=43,this.sorties[14]=31,this.sorties[15]=72,this.sorties[16]=53,this.sorties[17]=35,this.sorties[18]=86,this.sorties[19]=60,this.sorties[20]=38,this.sorties[21]=100,this.sorties[22]=69,this.sorties[23]=44,this.sorties[24]=108,this.sorties[25]=79,this.sorties[26]=53,this.sorties[27]=120,this.sorties[28]=90,this.sorties[29]=60,this.eff_s[0]=-1.5,this.eff_s[1]=0,this.eff_s[2]=1.5,this.eff_s[3]=-1.5,this.eff_s[4]=.5,this.eff_s[5]=1.2,this.eff_s[6]=-1.3,this.eff_s[7]=.7,this.eff_s[8]=1.3,this.eff_s[9]=-.5,this.eff_s[10]=1.3,this.eff_s[11]=1.2,this.eff_s[12]=-.5,this.eff_s[13]=1.3,this.eff_s[14]=1.1,this.eff_s[15]=-.3,this.eff_s[16]=.8,this.eff_s[17]=1.2,this.eff_s[18]=0,this.eff_s[19]=.7,this.eff_s[20]=1.2,this.eff_s[21]=0,this.eff_s[22]=.5,this.eff_s[23]=1.5,this.eff_s[24]=-.6,this.eff_s[25]=.2,this.eff_s[26]=1.5,this.eff_s[27]=-.65,this.eff_s[28]=0,this.eff_s[29]=1.5}return Object(r.a)(t,[{key:"choc_bande",value:function(t){var e=NaN;return!(this.X[t]>this.XMIN&&this.X[t]<this.XMAX&&this.Y[t]>this.YMIN&&this.Y[t]<this.YMAX)&&(!(this.X[t]<this.XMIN&&this.Vx[t]>0)&&(!(this.X[t]>this.XMAX&&this.Vx[t]<0)&&(!(this.Y[t]>this.YMAX&&this.Vy[t]<0)&&(!(this.Y[t]<this.YMIN&&this.Vy[t]>0)&&(this.etat[t]===this.RSG?(this.Rp[t]=-this.Vy[t],this.Rq[t]=this.Vx[t]):this.etat[t]===this.QCQ&&(this.Rp[t]=-this.Vy[t]+this.VQy[t],this.Rq[t]=this.Vx[t]-this.VQx[t]),this.init_pars(t),this.VMz=this.VT-this.VRr,this.VN0=-this.VN,this.VN=this.VN*-this.EPSILON,this.deltaVN=this.VN0+this.VN,this.intens=this.VN0/20,this.intens>1&&(this.intens=1),this.beta_adh=2/7*Math.sqrt(this.VMz*this.VMz+this.VRq*this.VRq),this.beta_gliss=this.f1*this.deltaVN,Math.abs(this.VMz)<1e-5?this.alpha_bande=Math.PI/2:this.alpha_bande=Math.abs(Math.atan(this.VRq/this.VMz)),e=Math.abs(this.fp1*this.deltaVN),Math.abs(this.VRp)<e?this.VRp=0:this.VRp>0?this.VRp=this.VRp-e:this.VRp=this.VRp+e,e=Math.abs(this.f2*this.deltaVN),this.VRq=this.VRq+e,this.choc_adh(t),this.recup_pars(t),this.VQx[t]=this.Vx[t]-this.Rq[t],this.VQy[t]=this.Vy[t]+this.Rp[t],this.etat[t]=this.QCQ,!0)))))}},{key:"mise_a_jour",value:function(t){var e=NaN,s=NaN,i=NaN,a=NaN,n=NaN;if(this.etat[t]===this.RSG){if((e=Math.sqrt(this.Vx[t]*this.Vx[t]+this.Vy[t]*this.Vy[t]))<this.frpas){var o=0;if(this.Vy[t]=0,this.Vx[t]=o,o=0,this.Rq[t]=0,this.Rp[t]=o,Math.abs(this.Rr[t])<this.Rfppas)return this.date_arret[t]=this.date*this.pas,this.etat[t]=this.ARRET,this.Rr[t]=0,this.add_clef(t),!0;this.etat[t]=this.TSP}this.etat[t]!==this.TSP&&(s=1-this.frpas/e,this.Vx[t]=this.Vx[t]*s,this.Vy[t]=this.Vy[t]*s,this.Rp[t]=-this.Vy[t],this.Rq[t]=this.Vx[t]),Math.abs(this.Rr[t])<this.Rfppas?this.Rr[t]=0:this.Rr[t]>0?this.Rr[t]=this.Rr[t]-this.Rfppas:this.Rr[t]=this.Rr[t]+this.Rfppas}if(this.etat[t]===this.QCQ&&((i=Math.sqrt(this.VQx[t]*this.VQx[t]+this.VQy[t]*this.VQy[t]))<this.delta_fgpas?this.etat[t]=this.RSG:(a=-this.fgpas*this.VQx[t]/i,n=-this.fgpas*this.VQy[t]/i,this.Vx[t]=this.Vx[t]+a,this.Vy[t]=this.Vy[t]+n,s=1-this.delta_fgpas/i,this.VQx[t]=this.VQx[t]*s,this.VQy[t]=this.VQy[t]*s),this.Rp[t]=-this.Vy[t]+this.VQy[t],this.Rq[t]=this.Vx[t]-this.VQx[t],Math.abs(this.Rr[t])<this.Rfppas?this.Rr[t]=0:this.Rr[t]>0?this.Rr[t]=this.Rr[t]-this.Rfppas:this.Rr[t]=this.Rr[t]+this.Rfppas),this.etat[t]===this.TSP){if(o=0,this.Vy[t]=0,this.Vx[t]=o,o=0,this.Rq[t]=0,this.Rp[t]=o,Math.abs(this.Rr[t])<this.Rfppas)return this.Rr[t]=0,this.date_arret[t]=this.date*this.pas,this.etat[t]=this.ARRET,!0;this.Rr[t]>0?this.Rr[t]=this.Rr[t]-2*this.Rfppas:this.Rr[t]=this.Rr[t]+2*this.Rfppas}return this.X[t]=this.X[t]+this.Vx[t]*this.pas,this.Y[t]=this.Y[t]+this.Vy[t]*this.pas,this.RAp[t]=this.RAp[t]+this.Rp[t]*this.pas,this.RAq[t]=this.RAq[t]+this.Rq[t]*this.pas,this.RAr[t]=this.RAr[t]+this.Rr[t]*this.pas,!1}},{key:"choc_adh",value:function(t){var e,s,i=NaN,a=NaN,n=NaN,o=NaN,h=NaN,r=0;i=Math.abs(this.VT)<1e-5?90:180/Math.PI*Math.atan(this.VN0/this.VT),this.effet=100*this.R/2*this.VRr/Math.sqrt(this.VN0*this.VN0+this.VT*this.VT),this.effet<=-1.5?this.effet=-1.499:this.effet>1.5&&(this.effet=1.499),Math.abs(this.VT)<1e-5?a=this.effet>0?this.sorties[28]+(this.sorties[29]-this.sorties[28])*(this.effet/1.5):this.sorties[27]+(this.sorties[28]-this.sorties[27])*(this.effet+1.5)/1.5:(i=180/Math.PI*Math.atan(this.VN0/this.VT),r=parseInt(i/10,10),a=(n=this.effet>0?this.sorties[3*r+1]+(this.sorties[3*r+2]-this.sorties[3*r+1])*(this.effet/1.5):this.sorties[3*r+0]+(this.sorties[3*r+1]-this.sorties[3*r+0])*(this.effet+1.5)/1.5)+((this.effet>0?this.sorties[3*(r+1)+1]+(this.sorties[3*(r+1)+2]-this.sorties[3*(r+1)+1])*(this.effet/1.5):this.sorties[3*(r+1)+0]+(this.sorties[3*(r+1)+1]-this.sorties[3*(r+1)+0])*(this.effet+1.5)/1.5)-n)/10*(i-10*r)),Math.abs(a-90)<1e-5?this.VT=0:this.VT=a<90?this.VN/Math.tan(a/180*Math.PI):-this.VN*Math.tan((a-90)/180*Math.PI),Math.abs(this.VT)<1e-5?this.effet>0?this.e_s=this.eff_s[28]+(this.eff_s[29]-this.eff_s[28])*(this.effet/1.5):this.e_s=this.eff_s[27]+(this.eff_s[28]-this.eff_s[27])*(this.effet+1.5)/1.5:(this.effet>0?(o=this.eff_s[3*r+1]+(this.eff_s[3*r+2]-this.eff_s[3*r+1])*(this.effet/1.5),h=this.eff_s[3*(r+1)+1]+(this.eff_s[3*(r+1)+2]-this.eff_s[3*(r+1)+1])*(this.effet/1.5)):(o=this.eff_s[3*r+0]+(this.eff_s[3*r+1]-this.eff_s[3*r+0])*(this.effet+1.5)/1.5,h=this.eff_s[3*(r+1)+0]+(this.eff_s[3*(r+1)+1]-this.eff_s[3*(r+1)+0])*(this.effet+1.5)/1.5),this.e_s=o+(h-o)/10*(i-10*r)),s=(5*this.VN+2*this.VRq)/7,e=(5*this.VT-2*this.VRp)/7,this.VRr=.02*this.e_s/this.R*Math.sqrt(s*s+e*e)}},{key:"recup_pars",value:function(t){this.X[t]>this.XMAX&&this.Vx[t]>0&&(this.Vx[t]=-this.VN,this.Rq[t]=-this.VRq,this.Vy[t]>0?(this.Vy[t]=this.VT,this.Rp[t]=this.VRp,this.Rr[t]=-this.VRr):(this.Vy[t]=-this.VT,this.Rp[t]=-this.VRp,this.Rr[t]=this.VRr)),this.X[t]<this.XMIN&&this.Vx[t]<0&&(this.Vx[t]=this.VN,this.Rq[t]=this.VRq,this.Vy[t]>0?(this.Vy[t]=this.VT,this.Rp[t]=this.VRp,this.Rr[t]=this.VRr):(this.Vy[t]=-this.VT,this.Rp[t]=-this.VRp,this.Rr[t]=-this.VRr)),this.Y[t]<this.YMIN&&this.Vy[t]<0&&(this.Vy[t]=this.VN,this.Rp[t]=-this.VRq,this.Vx[t]>0?(this.Vx[t]=this.VT,this.Rq[t]=-this.VRp,this.Rr[t]=-this.VRr):(this.Vx[t]=-this.VT,this.Rq[t]=this.VRp,this.Rr[t]=this.VRr)),this.Y[t]>this.YMAX&&this.Vy[t]>0&&(this.Vy[t]=-this.VN,this.Rp[t]=this.VRq,this.Vx[t]>0?(this.Vx[t]=this.VT,this.Rq[t]=-this.VRp,this.Rr[t]=this.VRr):(this.Vx[t]=-this.VT,this.Rq[t]=this.VRp,this.Rr[t]=-this.VRr))}},{key:"Symetrise_Params",value:function(t,e){1!==e&&4!==e||(this.X[t]=-this.X[t],this.Vx[t]=-this.Vx[t],this.VQx[t]=-this.VQx[t]),3!==e&&4!==e||(this.Y[t]=-this.Y[t],this.Vy[t]=-this.Vy[t],this.VQy[t]=-this.VQy[t])}},{key:"choc_gliss",value:function(t){this.VMz>0?(this.VT=this.VT-this.beta_gliss*Math.cos(this.alpha_bande),this.VRr=this.VRr+2.5*this.beta_gliss*Math.cos(this.alpha_bande)):(this.VT=this.VT+this.beta_gliss*Math.cos(this.alpha_bande),this.VRr=this.VRr-2.5*this.beta_gliss*Math.cos(this.alpha_bande))}},{key:"choc_billes",value:function(t){var e=0,s=0,i=!1,a=NaN,n=NaN,o=0,h=NaN,r=NaN,l=NaN,c=NaN,p=NaN,u=NaN,d=NaN,f=NaN,m=NaN,b=NaN,g=NaN,v=NaN,R=NaN,V=NaN,M=NaN,w=NaN,P=NaN,y=NaN,_=!1,C=[];for(e=0;e<16;)C[e]=!1,e++;for(e=0;e<16;){if(this.etat[e]!==this.EMPOCHEE&&!C[e]){for(i=!1,o=e+1;o<16&&!i;){if(this.etat[o]!==this.EMPOCHEE&&(a=(this.X[e]-this.X[o])*(this.X[e]-this.X[o])+(this.Y[e]-this.Y[o])*(this.Y[e]-this.Y[o]))<this.D*this.D&&(this.etat[e]!==this.ARRET||this.etat[o]!==this.ARRET)&&(this.Vx[e]-this.Vx[o])*(this.X[o]-this.X[e])+(this.Vy[e]-this.Vy[o])*(this.Y[o]-this.Y[e])>0){i=!0;var x=!0;C[o]=!0,C[e]=x,s=o,_=!0,t[0]=e,t[1]=s}o++}if(i){x=!1,this.immobile[s]=!1,this.immobile[e]=x,this.add_clef(e),this.add_clef(s),C[e]=!0,this.etat[e]===this.RSG&&(this.Rp[e]=-this.Vy[e],this.Rq[e]=this.Vx[e]),this.etat[e]===this.QCQ&&(this.Rp[e]=-this.Vy[e]+this.VQy[e],this.Rq[e]=this.Vx[e]-this.VQx[e]),this.etat[e]===this.ARRET&&(this.Rp[e]=0,this.Rq[e]=0),C[s]=!0,this.etat[s]===this.RSG&&(this.Rp[s]=-this.Vy[s],this.Rq[s]=this.Vx[s]),this.etat[s]===this.QCQ&&(this.Rp[s]=-this.Vy[s]+this.VQy[s],this.Rq[s]=this.Vx[s]-this.VQx[s]),this.etat[s]===this.ARRET&&(this.Rp[s]=0,this.Rq[s]=0),h=(m=this.Vx[e]*(this.X[s]-this.X[e])+this.Vy[e]*(this.Y[s]-this.Y[e]))*(this.X[s]-this.X[e])/a,r=m*(this.Y[s]-this.Y[e])/a,l=this.Vx[e]-h,c=this.Vy[e]-r,p=(b=this.Vx[s]*(this.X[e]-this.X[s])+this.Vy[s]*(this.Y[e]-this.Y[s]))*(this.X[e]-this.X[s])/a,u=b*(this.Y[e]-this.Y[s])/a,d=this.Vx[s]-p,f=this.Vy[s]-u,v=h-p,R=r-u,this.intens=(v*v+R*R)/5,this.intens>1&&(this.intens=1),this.evts_son[this.nb_sons]=new X,this.evts_son[this.nb_sons].played=!1,this.evts_son[this.nb_sons].temps=this.date*this.pas,this.evts_son[this.nb_sons].intensite=this.intens,this.evts_son[this.nb_sons].type_choc=2,x=this;var S=this.nb_sons+1;x.nb_sons=S,g=h,h=p,p=g,p*=this.RendementChoc,h*=this.RendementChoc,g=r,r=u,u=g,u*=this.RendementChoc,r*=this.RendementChoc,this.Vx[e]=h+l,this.Vy[e]=r+c,this.VQx[e]=this.Vx[e]-this.Rq[e],this.VQy[e]=this.Vy[e]+this.Rp[e],this.etat[s]===this.ARRET&&(this.Vx[s]=.94*this.Vx[s],this.Vy[s]=.94*this.Vy[s],m/=n=Math.sqrt(a),m=Math.abs(m),P=this.fbille*m,V=Math.abs(this.Rp[e]*(this.Y[s]-this.Y[e])-this.Rq[e]*(this.X[s]-this.X[e]))/n,w=(this.Vx[e]*(this.Y[s]-this.Y[e])-this.Vy[e]*(this.X[s]-this.X[e]))/n-this.Rr[e],M=Math.abs(w)<1e-5?Math.PI/2:Math.abs(Math.atan(V/w)),y=(w>0?1:-1)*P*Math.cos(M),this.Rr[s]=2.5*y,this.Rr[e]=this.Rr[e]-2.5*y,d=y*(this.Y[s]-this.Y[e])/n,f=-y*(this.X[s]-this.X[e])/n),this.Vx[s]=p+d,this.Vy[s]=u+f,this.VQx[s]=this.Vx[s]-this.Rq[s],this.VQy[s]=this.Vy[s]+this.Rp[s],this.etat[s]=this.QCQ,this.etat[e]=this.QCQ}}e++}return _}},{key:"fin_parcours",value:function(){var t=0;for(t=0;t<16;){if(this.etat[t]!==this.ARRET&&this.etat[t]!==this.EMPOCHEE){if(!(this.Vx[t]*this.Vx[t]+this.Vy[t]*this.Vy[t]<this.frpas*this.frpas))return!1;if(!(Math.abs(this.Rr[t])<this.Rfppas))return this.etat[t]=this.TSP,!1;this.date_arret[t]=this.date*this.pas,this.etat[t]=this.ARRET;var e=0;this.Vy[t]=0,this.Vx[t]=e,e=0,this.Rr[t]=0,this.Rq[t]=e,this.Rp[t]=e}t++}return!0}},{key:"choc_poche",value:function(t,e){var s,i=NaN;this.etat[t]===this.RSG?(this.Rp[t]=-this.Vy[t],this.Rq[t]=this.Vx[t]):this.etat[t]===this.QCQ&&(this.Rp[t]=-this.Vy[t]+this.VQy[t],this.Rq[t]=this.Vx[t]-this.VQx[t]),i=this.Vx[t]*Math.cos(e)+this.Vy[t]*Math.sin(e),s=-this.Vx[t]*Math.sin(e)+this.Vy[t]*Math.cos(e),i*=-this.EPSILON_COIN,this.Vx[t]=i*Math.cos(e)-s*Math.sin(e),this.Vy[t]=i*Math.sin(e)+s*Math.cos(e),this.VQx[t]=this.Vx[t]-this.Rq[t],this.VQy[t]=this.Vy[t]+this.Rp[t],this.etat[t]=this.QCQ}},{key:"add_clef",value:function(t){var e=this.nb_max_clefs*t+this.nb_clefs[t];this.evts[e]=new I,this.evts[e].X=this.X[t],this.evts[e].Y=this.Y[t],this.evts[e].RAp=this.RAp[t],this.evts[e].RAq=this.RAq[t],this.evts[e].RAr=this.RAr[t],this.evts[e].time=this.date*this.pas;var s=this.nb_clefs,i=t,a=s[t]+1;s[i]=a,this.X0[t]=this.X[t],this.Y0[t]=this.Y[t],this.RAp0[t]=this.RAp[t],this.RAq0[t]=this.RAq[t],this.RAr0[t]=this.RAr[t]}},{key:"init_pars",value:function(t){this.X[t]>this.XMAX&&this.Vx[t]>0&&(this.VN=-this.Vx[t],this.VRq=-this.Rq[t],this.Vy[t]>0?(this.VT=this.Vy[t],this.VRp=this.Rp[t],this.VRr=-this.Rr[t]):(this.VT=-this.Vy[t],this.VRp=-this.Rp[t],this.VRr=this.Rr[t])),this.X[t]<this.XMIN&&this.Vx[t]<0&&(this.VN=this.Vx[t],this.VRq=this.Rq[t],this.Vy[t]>0?(this.VT=this.Vy[t],this.VRp=this.Rp[t],this.VRr=this.Rr[t]):(this.VT=-this.Vy[t],this.VRp=-this.Rp[t],this.VRr=-this.Rr[t])),this.Y[t]<this.YMIN&&this.Vy[t]<0&&(this.VN=this.Vy[t],this.VRq=-this.Rp[t],this.Vx[t]>0?(this.VT=this.Vx[t],this.VRp=-this.Rq[t],this.VRr=-this.Rr[t]):(this.VT=-this.Vx[t],this.VRp=this.Rq[t],this.VRr=this.Rr[t])),this.Y[t]>this.YMAX&&this.Vy[t]>0&&(this.VN=-this.Vy[t],this.VRq=this.Rp[t],this.Vx[t]>0?(this.VT=this.Vx[t],this.VRp=-this.Rq[t],this.VRr=this.Rr[t]):(this.VT=-this.Vx[t],this.VRp=this.Rq[t],this.VRr=-this.Rr[t]))}},{key:"Calcul",value:function(t){var e,s,i=0,a=0,n=0,o=NaN,h=[0,0];for(i=0;i<16;){for(this.nb_clefs[i]=0,a=0;a<this.nb_max_clefs;)this.evts[this.nb_max_clefs*i+a]=null,a++;i++}for(this.nb_sons=0,i=0;i<this.nb_max_sons;)this.evts_son[i]=null,i++;for(i=0;i<16;)this.X[i]=t.Xinit[i],this.Y[i]=t.Yinit[i],this.RAp[i]=t.RApInit[i],this.RAq[i]=t.RAqInit[i],this.RAr[i]=t.RArInit[i],this.add_clef(i),i++;this.el=t.el,this.er=t.er,this.alph=t.alphaQ,this.beta=t.betaQ,this.vqueue=t.Vqueue,this.calculs_finis=!1,this.nbandes=0,this.done=!1,this.distance13=2,this.first_bille_choquee=0,this.choc12=!1,this.choc13=!1,this.done=!1,this.deltaclef=this.resolution,this.date=0,this.beta=this.beta+Math.PI,this.Vinit=1.4*this.vqueue*Math.cos(this.alph/1.2),e=-2*this.Vinit/Math.cos(this.alph/1.1)*this.er/this.R;var r=Math.PI/20;o=this.alph>r?Math.PI/2/(Math.PI/2-r)*(this.alph-r):0,s=4*this.vqueue*Math.sin(o)*this.el/this.R,this.Vx[0]=this.Vinit*Math.cos(this.beta),this.Vx0=this.Vx[0],this.Vy[0]=this.Vinit*Math.sin(this.beta),this.Vy0=this.Vy[0];var l=e*Math.sin(this.beta)+s*Math.cos(this.beta);for(this.Rp[0]=e*Math.sin(this.beta)+s*Math.cos(this.beta),this.p0=l,l=-e*Math.cos(this.beta)+s*Math.sin(this.beta),this.Rq[0]=-e*Math.cos(this.beta)+s*Math.sin(this.beta),this.q0=l,l=2*this.el/this.R*this.Vinit,this.Rr[0]=2*this.el/this.R*this.Vinit,this.r0=l,this.VQx[0]=this.Vx[0]-this.Rq[0],this.VQy[0]=this.Vy[0]+this.Rp[0],this.etat[0]=this.QCQ,this.time_empochee[0]=1e3,this.immobile[0]=!1,this.date_arret[0]=1e3,i=1;i<16;)this.Vx[i]=0,this.Vy[i]=0,this.VQx[i]=0,this.VQy[i]=0,this.Rp[i]=0,this.Rq[i]=0,this.Rr[i]=0,t.empocheeInit[i]?(this.etat[i]=this.EMPOCHEE,this.time_empochee[i]=0):(this.etat[i]=this.ARRET,this.time_empochee[i]=1e3,this.immobile[i]=!0,this.date_arret[i]=1e3,this.add_clef(i)),i++;this.evts_son[this.nb_sons]=new X,this.evts_son[this.nb_sons].played=!1,this.evts_son[this.nb_sons].temps=0,this.evts_son[this.nb_sons].intensite=this.Vinit/5.4,this.alph>Math.PI/4?this.evts_son[this.nb_sons].type_choc=0:this.evts_son[this.nb_sons].type_choc=1,l=this;var c=this.nb_sons+1;for(l.nb_sons=c;!this.fin_parcours();)for(l=this,c=this.date+1,l.date=c,this.choc_billes(h),i=0;i<16;)this.etat[i]!==this.ARRET&&this.etat[i]!==this.EMPOCHEE&&(1===(n=this.traiter_poches(i))&&this.choc_bande(i)&&(this.add_clef(i),this.evts_son[this.nb_sons]=new X,this.evts_son[this.nb_sons].played=!1,this.evts_son[this.nb_sons].temps=this.date*this.pas,this.evts_son[this.nb_sons].intensite=this.intens,this.evts_son[this.nb_sons].type_choc=3,l=this,c=this.nb_sons+1,l.nb_sons=c),3===n&&this.add_clef(i),4===n&&(this.add_clef(i),this.evts_son[this.nb_sons]=new X,this.evts_son[this.nb_sons].played=!1,this.evts_son[this.nb_sons].temps=this.date*this.pas,this.evts_son[this.nb_sons].intensite=.8,this.evts_son[this.nb_sons].type_choc=4,l=this,c=this.nb_sons+1,l.nb_sons=c),this.mise_a_jour(i)&&this.add_clef(i)),(Math.abs(this.X[i]-this.X0[i])>this.deltaclef||Math.abs(this.Y[i]-this.Y0[i])>this.deltaclef||Math.abs(this.RAp[i]-this.RAp0[i])>this.deltaclefRot||Math.abs(this.RAq[i]-this.RAq0[i])>this.deltaclefRot||Math.abs(this.RAr[i]-this.RAr0[i])>this.deltaclefRot)&&this.add_clef(i),i++;if(this.fin_parcours()){for(this.calculs_finis=!0,i=0;i<16;)this.Xfin[i]=this.X[i],this.Yfin[i]=this.Y[i],this.RApfin[i]=this.RAp[i],this.RAqfin[i]=this.RAq[i],this.RArfin[i]=this.RAr[i],this.empochee_fin[i]=this.etat[i]===this.EMPOCHEE,this.add_clef(i),i++;this.duree=this.date*this.pas}else for(i=0;i<16;)this.add_clef(i),i++;return{pottingTime:this.time_empochee,sounds:this.evts_son,data:this.evts}}},{key:"traiter_poches",value:function(t){var e=0,s=NaN,i=NaN,a=NaN,n=NaN;this.X[t]>0&&this.Y[t]>0&&(e=1),this.X[t]<0&&this.Y[t]>0&&(e=2),this.X[t]<0&&this.Y[t]<0&&(e=3),this.X[t]>0&&this.Y[t]<0&&(e=4),this.Symetrise_Params(t,e);var o=0;return Math.sqrt((this.X[t]-this.XTROU)*(this.X[t]-this.XTROU)+(this.Y[t]-this.YTROU)*(this.Y[t]-this.YTROU))<this.RTROU?(this.etat[t]=this.EMPOCHEE,this.time_empochee[t]=this.date*this.pas,o=4,this.Symetrise_Params(t,e),o):Math.sqrt((this.X[t]-this.XTROU2)*(this.X[t]-this.XTROU2)+(this.Y[t]-this.YTROU2)*(this.Y[t]-this.YTROU2))<this.RTROU?(this.etat[t]=this.EMPOCHEE,this.time_empochee[t]=this.date*this.pas,o=4,this.Symetrise_Params(t,e),o):(this.X[t]<this.XMIN&&(this.Y[t]<this.YA&&this.Vx[t]<0?o=1:(s=Math.sqrt((this.X[t]-this.XA)*(this.X[t]-this.XA)+(this.Y[t]-this.YA)*(this.Y[t]-this.YA)))<this.R?this.Vx[t]*(this.X[t]-this.XA)+this.Vy[t]*(this.Y[t]-this.YA)<0&&(i=Math.acos((this.X[t]-this.XA)/s),this.choc_poche(t,i),o=3):this.Y[t]>this.YB&&(this.Vy[t]<0||Math.atan(-this.Vy[t]/this.Vx[t])<this.angle_poche_coin)&&this.Y[t]<this.a1*this.X[t]+this.b1?(this.choc_poche(t,Math.PI/2-this.angle_poche_coin),o=3):o=2),this.Y[t]>this.YMAX&&(this.X[t]>this.XC&&this.X[t]<this.XE&&this.Vy[t]>0?o=1:this.X[t]<this.XC?(a=Math.sqrt((this.X[t]-this.XC)*(this.X[t]-this.XC)+(this.Y[t]-this.YC)*(this.Y[t]-this.YC)))<this.R?this.Vx[t]*(this.X[t]-this.XC)+this.Vy[t]*(this.Y[t]-this.YC)<0&&(i=Math.acos((this.XC-this.X[t])/a),this.choc_poche(t,i),o=3):this.Y[t]>this.YD&&(this.Vx[t]>0||Math.atan(-this.Vy[t]/this.Vx[t])>Math.PI/2-this.angle_poche_coin)&&this.Y[t]>this.a2*this.X[t]+this.b2&&(this.choc_poche(t,this.angle_poche_coin),o=3):this.X[t]>this.XE?(n=Math.sqrt((this.X[t]-this.XE)*(this.X[t]-this.XE)+(this.Y[t]-this.YE)*(this.Y[t]-this.YE)))<this.R&&this.Y[t]<this.YE?this.Vx[t]*(this.X[t]-this.XE)+this.Vy[t]*(this.Y[t]-this.YE)<0&&(i=Math.PI/2+Math.acos((this.YE-this.Y[t])/n),this.choc_poche(t,i),o=3):this.Y[t]>this.YE&&this.Y[t]>this.a3*this.X[t]+this.b3?(this.choc_poche(t,this.angle_poche_centrale),o=3):o=2:o=2),this.Symetrise_Params(t,e),o)}}]),t}()),Yt=5.5,Lt=function(){function t(e,s,i,a,n,o,r,l,c,p){var u=this;Object(h.a)(this,t),this.unPot=function(t){u.objects.balls[t].getMesh().visibility=!0;var e=(Math.random()-.5)*(M-30),s=(Math.random()-.5)*(M-30)/2;u.objects.balls[t].getMesh().position.x=e,u.objects.balls[t].getMesh().position.z=s,0===t&&u.updateControlOptions(u.controlOptions)},this.potBall=function(t,e){console.log("pot",e),t.pot(),"function"===typeof u.onPotting&&u.onPotting(e)},this.toggleMute=function(t){u.bMuted=t},this.toggleObjectif=function(t){u.visibleObjectif=t,u.updateBat(u.controlOptions)},this.toggleFollowCam=function(t){u.bFollowCam=t,!0===t?u.cameras.setFixedTargetToStandCamera(u.objects.balls[0].getMesh()):u.cameras.setFixedTargetToStandCamera(null)},this.drawBallPath=function(t,e){u.bShowPathes=t,u.ballPathVisible=e.slice(0);var s=u.pathData;if(s&&0!==s.length){var i,a=Object(m.a)(u.pathes);try{for(a.s();!(i=a.n()).done;){var n=i.value;n&&n.dispose()}}catch(d){a.e(d)}finally{a.f()}u.pathes=[];var o=[new b.Color3(1,1,1),new b.Color3(1,.7,0),new b.Color3(0,.16,.43),new b.Color3(.72,0,.1),new b.Color3(.32,.18,.35),new b.Color3(.95,.24,.05),new b.Color3(.2,.2,.15),new b.Color3(.36,.25,.12),new b.Color3(0,0,0),new b.Color3(1,.7,0),new b.Color3(0,.16,.43),new b.Color3(.72,0,.1),new b.Color3(.32,.18,.35),new b.Color3(.95,.24,.05),new b.Color3(.2,.2,.15),new b.Color3(.36,.25,.12)];if(t)for(var h=0;h<16;h++){var r=[];if(!0===u.ballPathVisible[h]){for(var l=1e4*h;l<1e4*(h+1);l++)s[l]&&r.push(new b.Vector3(M*s[l].X/u.size,u.ballRadius/2,M*s[l].Y/u.size));var c=new b.StandardMaterial("mat1",u.scene);c.alpha=.5,c.diffuseColor=o[h],c.specularPower=1e3,c.specularColor=new b.Color3(.2,.2,.2);var p=new b.Mesh.CreateTube("tube-white",r,1,6,null,0,u.scene,!0,b.Mesh.FRONTSIDE);p.convertToFlatShadedMesh(),p.scaling.y=.1,p.material=c,u.pathes.push(p)}}}},this.configCameras=function(){var t=u;t.cameras=new U(t.scene,t.canvas,function(e,s){t.controlOptions.cueLine=e,t.controlOptions.cueAngle=s,"function"===typeof t.onControlOptionUpdate&&t.onControlOptionUpdate(t.controlOptions)}),t.changeView(t.currentView)},this.onOverlapped=function(t,e){t+=1,"function"===typeof u.onOverlapEvent&&(t>0?u.onOverlapEvent(Y[t],e):u.onOverlapEvent(-1))},this.loadModels=function(){var t=u,e=u.assetStorePath;b.SceneLoader.ImportMesh("",e,V,t.scene,function(s){s[0].convertToUnIndexedMesh(),t.shadowGenerator.getShadowMap().renderList.push(s[0]),t.objects.bat=new k(t.scene,s[0],t.ballRadius,t.onOverlapped),b.SceneLoader.ImportMesh("",e,v,t.scene,function(s){var i,a=Object(m.a)(s);try{for(a.s();!(i=a.n()).done;){var n=i.value;if(n.freezeWorldMatrix(),n.convertToFlatShadedMesh(),console.log(n.name),n.name.includes("wood"))try{t.surroundLight1.includedOnlyMeshes.push(n),t.surroundLight2.includedOnlyMeshes.push(n)}catch(o){console.log(o)}n.name.includes("rail")?(n.receiveShadows=!1,t.shadowGenerator.getShadowMap().renderList.push(n)):n.name.includes("carpet")&&(n.receiveShadows=!0)}}catch(h){a.e(h)}finally{a.f()}t.objects.table=new Q(t.scene,s,e),t.configCueBalls(),t.updateBat(t.controlOptions),setTimeout(function(){"function"===typeof t.onSceneLoaded&&t.onSceneLoaded()},2e3)})})},this.updateControlOptions=function(t,e){u.t0||(u.controlOptions=t,u.updateBat(t,e))},this.updateBat=function(t,e){var s=t.cueLine,i=t.cueAngle,a=t.sideEnglish,n=t.topSpin,o=u.size,h=u.ballRadius,r=u.cameras,l=u.objects,c=l.bat,p=l.balls,d=M*a/o,f=M*n/o;if(0!==p.length&&p[0]){var m=p[0].getPosition();if(!p[0].isPotted()){c.update({x:m.x-d*Math.sin(s)-f*Math.sin(i)*Math.cos(s),z:m.z+d*Math.cos(s)-f*Math.sin(i)*Math.sin(s),y:h/2+f*Math.cos(i)},{x:0,y:-s,z:Math.PI/2+i});for(var b=[],g=1;g<u.objects.balls.length;g++){var v=u.objects.balls[g];b.push([v.getPosition().x,v.getPosition().z,v.isPotted()])}c.updatePreviewPath(!0,M,u.size,u.ballRadius,u.controlOptions.cueLine,[u.objects.balls[0].getPosition().x,u.objects.balls[0].getPosition().z],b,u.visibleObjectif),r.updateTarget({x:m.x-d*Math.sin(s)-f*Math.sin(i)*Math.cos(s),z:m.z+d*Math.cos(s)-f*Math.sin(i)*Math.sin(s),y:h/2+f*Math.cos(i)},{x:0,y:-s,z:i}),r.changeView(u.currentView)}}},this.generateReflectionMaterial=function(t,e){for(var s=u.scene,i=new b.ReflectionProbe("satelliteProbe"+t.name,512,s),a=0;a<e.length;a++)i.renderList.push(e[a]);t.material.reflectionTexture=i.cubeTexture,t.material.reflectivityColor=new b.Color3(1,1,1),t.material.reflectionFresnelParameters=new b.FresnelParameters,t.material.reflectionFresnelParameters.bias=0,i.attachToMesh(t)},this.configCueBalls=function(){var t=u,e=u.assetStorePath,s=u.ballRadius,i=u.ballPositions;t.objects.balls.push(new B(t.scene,"cue-ball-white",s,{x:i[0].x,y:s/2,z:i[0].z},e,"cueball-white.jpg",!0));for(var a=1;a<16;a++){var n=new B(t.scene,"cue-ball-"+a,s,{x:i[a].x,y:s/2,z:i[a].z},e,"poolball/"+a+".png",!i[a].empocheeInit);t.objects.balls.push(n)}for(a=0;a<16;a++){var o=[];t.shadowGenerator.getShadowMap().renderList.push(t.objects.balls[a].getMesh());for(var h=0;h<16;h++)a!==h&&o.push(t.objects.balls[h].getMesh())}var r=[];for(a=1;a<16;a++)r.push(t.objects.balls[a].getMesh());var l,c=Object(m.a)(t.objects.table.getMeshes());try{for(c.s();!(l=c.n()).done;){var p=l.value;p.name.includes("rail")&&r.push(p)}}catch(d){c.e(d)}finally{c.f()}t.objects.bat.registerCollisions(r),t.objects.bat.onBatCollide(function(){"function"===typeof t.onBatCollide&&t.onBatCollide()})},this.configGrids=function(){for(var t=u,e=[new b.Color4(.7,.7,.7,1),new b.Color4(.7,.7,.7,1)],s=0;s<15;s++){var i=[new b.Vector3(7*-M/16+s*M/16,.5,-M/4),new b.Vector3(7*-M/16+s*M/16,.5,M/4)];t.grids.push(b.MeshBuilder.CreateLines("lines",{points:i,colors:e},t.scene))}for(s=0;s<7;s++){var a=[new b.Vector3(-M/2,.5,3*-M/16+s*M/16),new b.Vector3(M/2,.5,3*-M/16+s*M/16)];t.grids.push(b.MeshBuilder.CreateLines("lines",{points:a,colors:e},t.scene))}u.toggleGrids(!1)},this.toggleGrids=function(t){for(var e=u.grids,s=0;s<e.length;s++)e[s].visibility=t},this.configLightAndShadow=function(){var t=u,e=t.scene;t.scene.clearColor=new b.Color3(1,1,1),t.scene.ambientColor=new b.Color3(0,0,0),t.surroundLight1=new b.PointLight("surround-1",new b.Vector3(2*M,50,2*M),e),t.surroundLight1.intensity=10,t.surroundLight2=new b.PointLight("surround-2",new b.Vector3(2*-M,50,2*-M),e),t.surroundLight2.intensity=10;var s=new b.HemisphericLight("ambient1",new b.Vector3(0,1,0),e);s.intensity=.7,s.diffuse=new b.Color3(.9,.9,.9),s.specular=new b.Color3(0,0,0),s.groundColor=new b.Color3(0,0,0),t.directionalLight=new b.DirectionalLight("dir01",new b.Vector3(0,-1,0),e),t.directionalLight.intensity=3,t.directionalLight.position=new b.Vector3(0,200,0),t.shadowGenerator=new b.ShadowGenerator(1024,t.directionalLight),t.shadowGenerator.usePercentageCloserFiltering=!0,t.shadowGenerator.useBlurExponentialShadowMap=!0;var i=new b.Plane(0,1,0,0);i.normalize();var a=b.MeshBuilder.CreatePlane("floor",{height:1200,width:1200,sourcePlane:i,sideOrientation:b.Mesh.DOUBLESIDE},t.scene);a.position.y=-94;var n=new b.StandardMaterial("floor-mat",t.scene);n.diffuseTexture=new b.Texture(t.assetStorePath+"ground/ground-v.jpg",t.scene),a.material=n},this.initializeScene=function(t,e){var s=u;s.scene=t,s.canvas=e,s.configLightAndShadow(),s.configCameras(),s.loadModels(),s.configGrids();var i=g.AdvancedDynamicTexture.CreateFullscreenUI("UI");s.positionLabel=new g.Rectangle,s.positionLabel.width="0px",s.positionLabel.height="70px",s.positionLabel.color="white",s.positionLabel.fontSize=12,s.positionLabel.thickness=2,s.positionLabel.background="#11111188",s.positionLabel.linkOffsetY=-50,i.addControl(s.positionLabel),s.positionLabelText=new g.TextBlock,s.positionLabelText.textHorizontalAlignment=g.Control.HORIZONTAL_ALIGNMENT_LEFT,s.positionLabelText.left="20px",s.positionLabelText.text="X: 1.24m\nY: -0.18m",s.positionLabelText.fontSize="20px",s.positionLabelText.textWrapping=!0,s.positionLabel.addControl(s.positionLabelText),s.scene.getEngine().stopRenderLoop(),setInterval(function(){requestAnimationFrame(function(){s.animateBalls(),s.scene.render()})},parseInt(1e3/30,10)),e.addEventListener("mousedown",s.onPointerDown),e.addEventListener("mouseup",s.onPointerUp),e.addEventListener("mousemove",s.onPointerMove),e.addEventListener("pointerdown",s.onPointerDown,!1),e.addEventListener("pointerup",s.onPointerUp,!1),e.addEventListener("pointermove",s.onPointerMove,!1)},this.updateCueLineByPointer=function(t){var e=u;if("top"===e.currentView){var s=e.getGroundPosition(t);if(s){var i=e.objects.balls[0].getPosition(),a=i.x,n=i.z,o=s.x-a,h=s.z-n,r=Math.atan(h/o);o>=0&&(r+=Math.PI),e.controlOptions.cueLine=r,"function"===typeof e.onControlOptionUpdate&&e.onControlOptionUpdate(e.controlOptions)}}},this.getGroundPosition=function(){var t=u.scene,e=t.pick(t.pointerX,t.pointerY,function(t){return"carpet"===t.name});return e.hit?e.pickedPoint:null},this.onPointerDown=function(t){var e=u,s=u.scene;if(e.pointerPressed=!0,0===t.button&&"targetting"!==e.currentView){var i=s.pick(s.pointerX,s.pointerY,function(t){return t.name.includes("cue-ball")});if(i.hit){if(!1===i.pickedMesh.visibility)return;e.currentMesh=i.pickedMesh,e.startingPoint=e.getGroundPosition(t),e.positionLabel.width="130px",e.positionLabel.linkWithMesh(e.currentMesh),e.startingPoint=e.getGroundPosition(t),e.startingPoint&&setTimeout(function(){e.cameras.enableControl(!1)},0)}else e.updateCueLineByPointer(t)}},this.onPointerUp=function(){var t=u,e=u.startingPoint;if(t.pointerPressed=!1,e)return t.positionLabel.width="0px",t.positionLabel.linkWithMesh(null),t.cameras.enableControl(!0),t.startingPoint=null,t.currentMesh=null,void t.updateBat(t.controlOptions)},this.onPointerMove=function(t){var e=u,s=u.currentMesh;if(s){var i=e.getGroundPosition(t);if(!i)return;if(Math.abs(i.x)>=M/2-u.ballRadius/2||Math.abs(i.z)>=M/4-u.ballRadius/2)return;s.position=i,s.position.y=e.ballRadius/2,e.startingPoint=i;var a=i.x/M*e.size,n=i.z/M*e.size;a=Math.round(100*a)/100,n=Math.round(100*n)/100,e.positionLabelText.text="X: ".concat(a,"m\nY: ").concat(n,"m")}else e.pointerPressed&&e.updateCueLineByPointer(t)},this.moveAndRotateBall=function(t,e,s){if(t.isPotted())return!1;var i,a=u,n=e-a.t0;(n*=a.playbackSpeed?a.playbackSpeed:1)>=a.pottingTime[s]&&a.potBall(t,s);var o=W(a.pathData,1e4*s,1e4*(s+1)-1,n);if((i=o.index)>=0){var h=a.pathData[i],r=M*h.X/a.size,l=M*h.Y/a.size;isNaN(r)&&(r=0),isNaN(l)&&(l=0);var c=h.RAp,p=h.RAq,d=h.RAr;if(a.pathData[i+1]){var f=a.pathData[i+1],m=(n-h.time)/(f.time-h.time);r+=(M*f.X/a.size-r)*m,l+=(M*f.Y/a.size-l)*m,c+=(f.RAp-c)*m,p+=(f.RAq-p)*m,d+=(f.RAr-d)*m,isNaN(c)&&(c=0),isNaN(p)&&(p=0),isNaN(d)&&(d=0)}return t.updatePosition(r,l),t.updateRotation(c,p,d),!o.isLast}},this.animateBalls=function(){var t=u,e=u.objects.balls;if(t.pathData&&0!==t.pathData.length&&void 0!==t.t0)if(!0!==t.bPaused){for(var s=(new Date).getTime()/1e3,i=0,a=0;a<16;a++){!1===u.moveAndRotateBall(e[a],s,a)&&i++}if(16===i)return t.t0=void 0,t.bPaused=!1,setTimeout(function(){t.updateBat(t.controlOptions)},1e3),void t.cameras.setFixedTargetToStandCamera(null);if(!t.bMuted){var n=s-t.t0;for(n*=t.playbackSpeed?t.playbackSpeed:1,a=0;a<t.soundData.length;a++){var o=t.soundData[a];if(null!==o&&(t.soundData[a+1]&&o.temps<n&&t.soundData[a+1].temps>n&&!1===o.played))switch(o.played=!0,o.type_choc){case 1:t.sounds.playHit(o.intensite);break;case 2:t.sounds.playBallCollision(o.intensite);break;case 3:t.sounds.playRailCollision(o.intensite);break;case 4:t.sounds.playPotting(o.intensite)}}}}else console.log("paused")},this.getSimulationResult=function(t){var e=u;t||(t=u.controlOptions);var s,i=u.objects.balls,a=[],n=[],o=[],h=Object(m.a)(i);try{for(h.s();!(s=h.n()).done;){var r=s.value,l=r.getPosition();a.push(e.size*l.x/M),n.push(e.size*l.z/M),o.push(!r.getVisibility())}}catch(c){h.e(c)}finally{h.f()}return u.simul.Calcul({Xinit:a,Yinit:n,empocheeInit:o,RApInit:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],RAqInit:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],RArInit:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],el:t.sideEnglish,er:t.topSpin,alphaQ:t.cueAngle,betaQ:t.cueLine,Vqueue:t.speed})},this.playSimulation=function(t){if(!0===u.bPaused)return console.log("resume"),u.bPaused=!1,void(u.t0+=(new Date).getTime()/1e3-u.pausedTime);if(!u.t0){var e=u;e.playbackSpeed=t;var s,i=u.controlOptions,a=u.objects,n=a.balls,o=a.bat,h=[],r=[],l=[],c=Object(m.a)(n);try{for(c.s();!(s=c.n()).done;){var p=s.value,d=p.getPosition();h.push(e.size*d.x/M),r.push(e.size*d.z/M),l.push(!p.getVisibility())}}catch(b){c.e(b)}finally{c.f()}var f=u.getSimulationResult();o.animateHit(i.cueLine,i.cueAngle,i.speed),setTimeout(function(){f&&0!==f.length&&(e.pathData=f.data,e.soundData=f.sounds,e.pottingTime=f.pottingTime,e.drawBallPath(e.bShowPathes,e.ballPathVisible),e.bMuted||e.sounds.playHit(),e.t0=(new Date).getTime()/1e3,e.bPaused=!1,e.cameras.changeView("stand"),!0===e.bFollowCam?e.cameras.setFixedTargetToStandCamera(e.objects.balls[0].getMesh()):e.cameras.setFixedTargetToStandCamera(null))},850)}},this.getStatus=function(){var t=u.objects.balls,e={};e.isPlaying=!!u.t0,e.paused=u.bPaused,e.points={},e.points.Xinit=[],e.points.Yinit=[],e.points.empocheeInit=[];var s,i=Object(m.a)(t);try{for(i.s();!(s=i.n()).done;){var a=s.value;e.points.Xinit.push(a.getPosition().x/M*u.size),e.points.Yinit.push(a.getPosition().z/M*u.size),e.points.empocheeInit.push(a.isPotted())}}catch(n){i.e(n)}finally{i.f()}return e},this.pauseSimulation=function(){!0!==u.bPaused&&(u.bPaused=!0,u.pausedTime=(new Date).getTime()/1e3)},this.resetBallPoints=function(t){if(void 0!==t){u.t0=void 0,u.bPaused=!1;var e,s=Object(m.a)(u.pathes);try{for(s.s();!(e=s.n()).done;){var i=e.value;i&&i.dispose()}}catch(r){s.e(r)}finally{s.f()}for(var a in u.pathes=[],u.pathData=[],u.objects.balls){var n=u.objects.balls[a],o=t.Xinit[a]/u.size*M,h=t.Yinit[a]/u.size*M;n.getMesh().visibility=!0,n.updatePosition(o,h),!0===t.empocheeInit[a]&&n.pot()}}},this.scene=void 0,this.canvas=void 0,this.size=e,this.onSceneLoaded=p,this.onControlOptionUpdate=o,this.onBatCollide=r,this.onPotting=l,this.onOverlapEvent=c,this.ballRadius=M*Yt/(100*this.size),this.assetStorePath=s,this.initBallPosition=a,this.ballPositions=[],this.currentView=i,this.cameras=void 0,this.objects={table:void 0,bat:void 0,balls:[]},this.controlOptions=n,this.grids=[],this.pathes=[],this.bShowPathes=!1,this.bMuted=!1,this.bPaused=!1,this.bFollowCam=!0,this.simul=new Ot(1.24,.605),this.ballPathVisible=[];for(var d=0;d<16;d++)this.ballPositions.push({x:M*a.Xinit[d]/e,z:M*a.Yinit[d]/e,empocheeInit:a.empocheeInit[d]}),this.ballPathVisible.push(!0);this.sounds=new G(this.assetStorePath),this.visibleObjectif=!0}return Object(r.a)(t,[{key:"changeView",value:function(t){this.currentView=t,this.cameras.changeView(t)}}]),t}(),Xt=(s(332),[ct,pt,ut,dt,ft,mt,bt,gt,vt,Rt,Vt,Mt,wt,Pt,yt,_t]),It=function(t){Object(l.a)(s,t);var e=Object(c.a)(s);function s(t){var i;return Object(h.a)(this,s),(i=e.call(this,t)).componentWillReceiveProps=function(t){i.setState({ballStatus:t.data})},i.ballPressed=function(t){var e=i.state.ballStatus;e[t]=!1,i.setState({ballStatus:e}),i.props.onBallPressed(t)},i.state={ballStatus:[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0]},i}return Object(r.a)(s,[{key:"render",value:function(){var t=this,e=this.state.ballStatus;return a.a.createElement("div",{className:"ball-status-controller"+($.isMobile?" mobile-view":"")},Array.isArray(e)&&e.map(function(e,s){return a.a.createElement("img",{alt:"ball",className:"ball"+(e?"":" inactive"),key:s,src:Xt[s],onClick:function(){e&&t.ballPressed(s)}})}))}}]),s}(a.a.Component);function qt(){var t=Object(d.a)(["\n"]);return qt=function(){return t},t}var Bt=Object(K.css)(qt()),zt={width:"100%",height:"100%"},jt=function(t){Object(l.a)(s,t);var e=Object(c.a)(s);function s(t){var i;Object(h.a)(this,s),(i=e.call(this,t)).meshPicked=function(t){},i.drawBallPath=function(t,e){i.board.drawBallPath(t,e)},i.onSceneMount=function(t){var e=t.canvas,s=t.scene;i.board.initializeScene(s,e),window.addEventListener("resize",function(){s.getEngine().resize()}),$.isMobile&&s.getEngine().setHardwareScalingLevel(.5),s.getEngine().resize()},i.toggleGrids=function(t){i.board.toggleGrids(t)},i.toggleMute=function(t){i.board.toggleMute(t)},i.toggleObjectif=function(t){i.board.toggleObjectif(t)},i.toggleFollowCam=function(t){i.board.toggleFollowCam(t)},i.getStatus=function(){return i.board.getStatus()},i.playSimulation=function(t){i.board.playSimulation(t)},i.pauseSimulation=function(){i.board.pauseSimulation()},i.resetBallPoints=function(t){i.board.resetBallPoints(t)},i.updateControlOptions=function(t,e){i.board.updateControlOptions(t,e)},i.componentDidMount=function(){},i.componentWillReceiveProps=function(t){i.board.updateControlOptions({cueLine:t.cueLine,cueAngle:t.cueAngle,sideEnglish:t.sideEnglish,topSpin:t.topSpin,speed:t.speed})},i.updateBallStatus=function(t){i.setState({ballStatus:t.empocheeInit})},i.state={showPath:!1,isLoadingScene:!0,ballStatus:i.props.points.empocheeInit};var n=Object(u.a)(i);return i.board=new Lt(i.props.size,i.props.assetStorePath,i.props.currentView,i.props.points,{cueLine:i.props.cueLine,cueAngle:i.props.cueAngle,sideEnglish:i.props.sideEnglish,topSpin:i.props.topSpin,speed:i.props.speed},function(t){n.props.onControlOptionUpdate(t)},function(){var t=Object.assign({},i.props);t.cueAngle<Math.PI/180*89&&(t.cueAngle+=Math.PI/180,i.props.onControlOptionUpdate(t))},function(t){var e=i.state.ballStatus;e[t]=!0,i.setState({ballStatus:e})},function(t,e){i.props.onOverlapEvent(t,e)},function(){i.setState({isLoadingScene:!1})}),i.simulatorDom=new a.a.createRef,i}return Object(r.a)(s,[{key:"changeView",value:function(t){this.board.changeView(t)}},{key:"render",value:function(){var t=this,e=this.state,s=e.ballStatus,i=e.isLoadingScene;return a.a.createElement("div",{style:zt},a.a.createElement(f.a,{canvasId:"carom-simulator-canvas",antialias:!0},a.a.createElement(f.b,{onMeshPicked:this.meshPicked,onSceneMount:this.onSceneMount})),a.a.createElement(It,{data:s,onBallPressed:function(e){t.board.unPot(e)}}),!0===i?a.a.createElement("div",{className:"loading-icon-container"},a.a.createElement(tt.ClipLoader,{css:Bt,sizeUnit:"px",size:80,color:"#f0f0f0",loading:i})):null)}}]),s}(a.a.Component),kt=function(t){Object(l.a)(s,t);var e=Object(c.a)(s);function s(){var t;return Object(h.a)(this,s),(t=e.call(this)).componentWillMount=function(){t.updateSimulateInfo()},t.updateSimulateInfo=function(){var e=t.props.sequence,s=["Stephan COHEN","...","0","280","9","1","0.09016666666666652","-0.15416666666666667","0","-0.7000000000000001","0","1","-0.6000000000000001","0","1","-0.5","0","1","-0.4","0","1","-0.30000000000000004","0","1","1.1278562236304084","0.5949669539121291","0","-0.7158538054923216","0.28840047307995464","0","0.09842832940320168","-0.3689576159836725","0","0.6413658575465282","-0.03231798897590485","0","0.2","0","1","0.30000000000000004","0","1","0.4","0","1","0.5","0","1","0.6000000000000001","0","1","0.7000000000000001","0","1","1.8639999999999999","0.03490658503988659","-2.4890317318711697","0.014000000000000002","0.004999999999999999"];"string"===typeof e&&(s=e.split("\n"));for(var i={size:2.54,points:{Xinit:[],Yinit:[],empocheeInit:[]}},a=6,n=0;n<16;)i.points.Xinit[n]=s[a],a++,i.points.Yinit[n]=s[a],a++,0===parseInt(s[a],10)?i.points.empocheeInit[n]=!1:i.points.empocheeInit[n]=!0,a++,n++;i.speed=parseFloat(s[a]),a++,i.cueAngle=parseFloat(s[a]),a++,i.cueLine=parseFloat(s[a]),i.cueLine<0&&(i.cueLine+=2*Math.PI),a++,i.sideEnglish=parseFloat(s[a]),a++,i.topSpin=parseFloat(s[a]);var o={size:2.7,cueAngle:i.cueAngle,cueLine:i.cueLine,sideEnglish:i.sideEnglish,topSpin:i.topSpin,speed:i.speed,points:{Xinit:i.points.Xinit.slice(),Yinit:i.points.Yinit.slice(),empocheeInit:i.points.empocheeInit.slice()}};t.setState({current:i,initData:o})},t.cameraTypeChanged=function(e){t.setState({currentView:e}),t.simulator.current.changeView(e)},t.onToggleShowGrid=function(e){t.setState({showGrid:e}),t.simulator.current.toggleGrids(e)},t.onToggleShowPath=function(e){t.setState({showPath:e}),t.simulator.current.drawBallPath(e,t.state.ballPathVisible)},t.onToggleVolume=function(e){t.setState({muted:e}),t.simulator.current.toggleMute(e)},t.onToggleFollowCam=function(){var e=t.state.bFollowCamera;t.setState({bFollowCamera:!e}),t.simulator.current.toggleFollowCam(!e)},t.onNewSequence=function(){var e=t.state.current,s=e.size-.1;e.cueAngle=Math.PI/90,e.cueLine=Math.random()*Math.PI*2,e.topSpin=0,e.sideEnglish=0,e.points.Xinit=[],e.points.Yinit=[],e.points.empocheeInit=[];for(var i=0;i<16;i++){if(e.points.Xinit.push((.5-Math.random())*s),e.points.Yinit.push((.5-Math.random())*s/2),0===i)e.points.empocheeInit.push(!1);else 0===Math.round(100*Math.random())%2?e.points.empocheeInit.push(!1):e.points.empocheeInit.push(!0)}t.setState({current:e,hasPrevHit:!1,hasNextHit:!1}),t.hitHistory.clear(),t.simulator.current.resetBallPoints(e.points),t.simulator.current.updateBallStatus(e.points)},t.onPlayPressed=function(e){var s=t.simulator.current.getStatus();if(!1===s.isPlaying){var i=t.state.current,a=Object.assign({},i);a.points=s.points;var n=Object.assign({},t.hitHistory.getValues());t.hitHistory.clear(),n.undo.forEach(function(e){return t.hitHistory.push(Object.assign({},e))}),t.hitHistory.push(Object.assign({},a));var o=t.hitHistory.getValues(),h=0!==o.undo.length,r=0!==o.redo.length;t.setState({beforePlay:a,hasPrevHit:h,hasNextHit:r}),t.simulator.current.playSimulation(e)}else!0===s.paused&&t.simulator.current.playSimulation(e)},t.onPausePressed=function(){t.simulator.current.pauseSimulation()},t.onStopPressed=function(){var e=t.state.beforePlay;if(e){var s=Object.assign({},e);t.setState({current:s}),t.simulator.current.resetBallPoints(s.points),t.simulator.current.updateBallStatus(s.points)}},t.onResetPressed=function(){var e=t.state.initData,s={size:e.size,cueLine:e.cueLine,cueAngle:e.cueAngle,topSpin:e.topSpin,sideEnglish:e.sideEnglish,speed:e.speed,points:{Xinit:e.points.Xinit.slice(),Yinit:e.points.Yinit.slice(),empocheeInit:e.points.empocheeInit.slice()}};t.setState({current:s,initData:e,hasPrevHit:!1,hasNextHit:!1});var i=Object.assign({},e.points),a={Xinit:e.points.Xinit.slice(),Yinit:e.points.Yinit.slice(),empocheeInit:e.points.empocheeInit.slice()};t.hitHistory.clear(),t.simulator.current.resetBallPoints(i),t.simulator.current.updateBallStatus(a)},t.onControlOptionsUpdated=function(e,s){var i=t.state.current;i.cueAngle=e.cueAngle,i.cueLine=e.cueLine,i.sideEnglish=e.sideEnglish,i.speed=e.speed,i.topSpin=e.topSpin,t.setState({current:i}),t.simulator.current.updateControlOptions(i,s)},t.onUndo=function(){var e=t.hitHistory.getValues();if(e.undo.length>0){var s=e.undo[e.undo.length-1];t.hitHistory.undo();var i=t.hitHistory.getValues(),a=0!==i.undo.length,n=0!==i.redo.length,o=Object.assign({},s);t.setState({current:o,hasPrevHit:a,hasNextHit:n}),t.simulator.current.resetBallPoints(o.points),t.simulator.current.updateBallStatus(o.points)}},t.onRedo=function(){var e=t.hitHistory.getValues();if(e.redo.length>0){var s=e.redo[e.redo.length-1];t.hitHistory.redo();var i=t.hitHistory.getValues(),a=0!==i.undo.length,n=0!==i.redo.length,o=Object.assign({},s);t.setState({current:o,hasPrevHit:a,hasNextHit:n}),t.simulator.current.resetBallPoints(o.points),t.simulator.current.updateBallStatus(o.points)}},t.state={currentView:"targetting",showGrid:!1,showPath:!1,muted:!1,bFollowCamera:!0,hasPrevHit:!1,hasNextHit:!1,current:{size:310,cueLine:30/180*Math.PI,cueAngle:5/180*Math.PI,sideEnglish:-.0087,topSpin:.0075,speed:3.8,points:{Xinit:[],Yinit:[],empocheeInit:[]}},ballPathVisible:[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],showObjectif:!0},t.hitHistory=Object(p.a)(),t.simulator=a.a.createRef(),t.controller=a.a.createRef(),t}return Object(r.a)(s,[{key:"render",value:function(){var t=this,e=this.state,s=e.currentView,i=e.showGrid,n=e.showPath,o=e.muted,h=e.hasNextHit,r=e.hasPrevHit,l=e.showObjectif,c=e.ballPathVisible,p=e.bFollowCamera,u=this.state.current,d=u.size,f=u.cueLine,m=u.cueAngle,b=u.sideEnglish,g=u.topSpin,v=u.speed,R=u.points;return a.a.createElement("div",{id:"simulator-container",style:{position:"relative",height:"100%"}},a.a.createElement(jt,{assetStorePath:this.props.assetStorePath,ref:this.simulator,size:d,currentView:s,cueLine:f,cueAngle:m,sideEnglish:b,topSpin:g,speed:v,points:R,onControlOptionUpdate:function(e){var s=t.state.current;s.cueAngle=e.cueAngle,s.cueLine=e.cueLine,s.sideEnglish=e.sideEnglish,s.speed=e.speed,s.topSpin=e.topSpin,t.setState({current:s})},onOverlapEvent:function(e,s){t.controller.current.overlap(e,s)}}),a.a.createElement(At,{objectif:l,ballPathVisible:c,ballTextures:[ct,pt,ut,dt,ft,mt,bt,gt,vt,Rt,Vt,Mt,wt,Pt,yt,_t],onUpdateObjectif:function(e){t.setState({showObjectif:e},function(){t.simulator.current.toggleObjectif(e)})},onToggleBallPathVisible:function(e){c[e]=!c[e],t.setState({ballPathVisible:c},function(){t.onToggleShowPath(t.state.showPath)})}}),a.a.createElement(Nt,{ref:this.controller,showGrid:i,showPath:n,muted:o,bFollowCamera:p,currentView:s,cameraTypeChanged:this.cameraTypeChanged,cueLine:f,cueAngle:m,sideEnglish:b,topSpin:g,speed:v,onControlOptionsUpdated:this.onControlOptionsUpdated,onToggleShowGrid:this.onToggleShowGrid,onToggleShowPath:this.onToggleShowPath,onToggleVolume:this.onToggleVolume,onToggleFollowCam:this.onToggleFollowCam,onPlayPressed:this.onPlayPressed,onPausePressed:this.onPausePressed,onStopPressed:this.onStopPressed,onResetPressed:this.onResetPressed,onNewSequence:this.onNewSequence,onUndoPressed:this.onUndo,onRedoPressed:this.onRedo,hasPrevHit:r,hasNextHit:h}))}}]),s}(a.a.Component),Qt="https://cors-anywhere.herokuapp.com/https://kozoomdev.b-cdn.net/simulator/";var Ft=function(){return a.a.createElement("div",{className:"simulator-container"},a.a.createElement(kt,{assetStorePath:Qt}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(Ft,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})},93:function(t,e,s){}},[[146,1,2]]]);